<?xml version="1.0" encoding="UTF-8" ?>

<chapter xml:id="ch-probability" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Probability</title>

  <introduction>
    <p>
      Probability forms the foundation of statistics, and you're probably already
      aware of many of the ideas presented in this chapter. However, formalization 
      of probability concepts is likely new for most readers.
    </p>
    <p>
      While this chapter provides a theoretical foundation for the ideas in later 
      chapters and provides a path to a deeper understanding, mastery of the concepts 
      introduced in this chapter is not required for applying the methods introduced 
      in the rest of this book.
    </p>
  </introduction>

  <!-- Section 3.1: Defining probability -->
  <section xml:id="sec-defining-probability">
    <title>Defining probability</title>

    <introduction>
      <p>
        Statistics is based on probability, and while probability is not required 
        for the applied techniques in this book, it may help you gain a deeper 
        understanding of the methods and set a better foundation for future courses.
      </p>
    </introduction>

    <subsection xml:id="subsec-introductory-examples">
      <title>Introductory examples</title>
      
      <p>
        Before we get into technical ideas, let's walk through some basic examples 
        that may feel more familiar.
      </p>

      <example xml:id="ex-prob-of-1">
        <title>Probability of rolling a 1</title>
        <statement>
          <p>
            A <q>die</q>, the singular of dice, is a cube with six faces numbered 1, 2, 3, 4, 5, and 6. 
            What is the chance of getting 1 when rolling a die?
          </p>
        </statement>
        <solution>
          <p>
            If the die is fair, then the chance of a 1 is as good as the chance of any other number. 
            Since there are six outcomes, the chance must be 1-in-6 or, equivalently, <m>1/6</m>.
          </p>
        </solution>
      </example>

      <example xml:id="ex-prob-of-1-or-2">
        <title>Probability of rolling a 1 or 2</title>
        <statement>
          <p>What is the chance of getting a 1 or 2 in the next roll?</p>
        </statement>
        <solution>
          <p>
            1 and 2 constitute two of the six equally likely possible outcomes, so the chance of 
            getting one of these two outcomes must be <m>2/6 = 1/3</m>.
          </p>
        </solution>
      </example>

      <example xml:id="ex-prob-of-123456">
        <title>Probability of any outcome</title>
        <statement>
          <p>
            What is the chance of getting either 1, 2, 3, 4, 5, or 6 on the next roll?
          </p>
        </statement>
        <solution>
          <p>
            100%. The outcome must be one of these numbers.
          </p>
        </solution>
      </example>

      <example xml:id="ex-prob-not-2">
        <title>Probability of not rolling a 2</title>
        <statement>
          <p>What is the chance of not rolling a 2?</p>
        </statement>
        <solution>
          <p>
            Since the chance of rolling a 2 is <m>1/6</m> or <m>16.\overline{6}\%</m>, the chance of 
            not rolling a 2 must be <m>100\% - 16.\overline{6}\% = 83.\overline{3}\%</m> or <m>5/6</m>.
          </p>
          <p>
            Alternatively, we could have noticed that not rolling a 2 is the same as getting a 1, 3, 4, 5, 
            or 6, which makes up five of the six equally likely outcomes and has probability <m>5/6</m>.
          </p>
        </solution>
      </example>

      <example xml:id="ex-prob-of-2-ones">
        <title>Probability of two 1s</title>
        <statement>
          <p>
            Consider rolling two dice. If <m>1/6</m> of the time the first die is a 1 and <m>1/6</m> 
            of those times the second die is a 1, what is the chance of getting two 1s?
          </p>
        </statement>
        <solution>
          <p>
            If <m>16.\overline{6}\%</m> of the time the first die is a 1 and <m>1/6</m> of <em>those</em> 
            times the second die is also a 1, then the chance that both dice are 1 is <m>(1/6)\times (1/6)</m> 
            or <m>1/36</m>.
          </p>
        </solution>
      </example>
    </subsection>

    <subsection xml:id="subsec-probability-definition">
      <title>Probability</title>
      
      <p>
        We use probability to build tools to describe and understand apparent randomness. We often frame 
        probability in terms of a <term>random process</term> giving rise to an <term>outcome</term>.
      </p>
      
      <tabular>
        <row>
          <cell>Roll a die</cell>
          <cell><m>\rightarrow</m></cell>
          <cell>1, 2, 3, 4, 5, or 6</cell>
        </row>
        <row>
          <cell>Flip a coin</cell>
          <cell><m>\rightarrow</m></cell>
          <cell>H or T</cell>
        </row>
      </tabular>
      
      <p>
        Rolling a die or flipping a coin is a seemingly random process and each gives rise to an outcome.
      </p>

      <assemblage>
        <title>Probability</title>
        <p>
          The <term>probability</term> of an outcome is the proportion of times the outcome would occur 
          if we observed the random process an infinite number of times.
        </p>
      </assemblage>

      <p>
        Probability is defined as a proportion, and it always takes values between 0 and 1 (inclusively). 
        It may also be displayed as a percentage between 0% and 100%.
      </p>

      <p>
        Probability can be illustrated by rolling a die many times. Let <m>\hat{p}_n</m> be the proportion 
        of outcomes that are 1 after the first <m>n</m> rolls. As the number of rolls increases, <m>\hat{p}_n</m> 
        will converge to the probability of rolling a 1, <m>p = 1/6</m>. <xref ref="fig-die-prop"/> shows 
        this convergence for 100,000 die rolls. The tendency of <m>\hat{p}_n</m> to stabilize around <m>p</m> 
        is described by the <term>Law of Large Numbers</term>.
      </p>

      <figure xml:id="fig-die-prop">
        <caption>
          The fraction of die rolls that are 1 at each stage in a simulation. The proportion tends to get 
          closer to the probability <m>1/6 \approx 0.167</m> as the number of rolls increases.
        </caption>
        <image source="ch_probability/figures/dieProp"/>
      </figure>

      <assemblage>
        <title>Law of Large Numbers</title>
        <p>
          As more observations are collected, the proportion <m>\hat{p}_n</m> of occurrences with a 
          particular outcome converges to the probability <m>p</m> of that outcome.
        </p>
      </assemblage>

      <p>
        Occasionally the proportion will veer off from the probability and appear to defy the Law of Large 
        Numbers, as <m>\hat{p}_n</m> does many times in <xref ref="fig-die-prop"/>. However, these deviations 
        become smaller as the number of rolls increases.
      </p>

      <p>
        Above we write <m>p</m> as the probability of rolling a 1. We can also write this probability as
        <me>P(\text{rolling a 1})</me>
        As we become more comfortable with this notation, we will abbreviate it further. For instance, if it 
        is clear that the process is <q>rolling a die</q>, we could abbreviate <m>P(\text{rolling a 1})</m> 
        as <m>P(1)</m>.
      </p>

      <exercise xml:id="ex-random-process">
        <title>Random processes</title>
        <statement>
          <p>
            Random processes include rolling a die and flipping a coin. (a) Think of another random process. 
            (b) Describe all the possible outcomes of that process. For instance, rolling a die is a random 
            process with possible outcomes 1, 2, <ellipsis />, 6.
          </p>
        </statement>
        <solution>
          <p>
            Here are four examples. (i) Whether someone gets sick in the next month or not is an apparently 
            random process with outcomes sick and not. (ii) We can <em>generate</em> a random process by 
            randomly picking a person and measuring that person's height. The outcome of this process will be 
            a positive number. (iii) Whether the stock market goes up or down next week is a seemingly random 
            process with possible outcomes up, down, and no change. Alternatively, we could have used the 
            percent change in the stock market as a numerical outcome. (iv) Whether your roommate cleans her 
            dishes tonight probably seems like a random process with possible outcomes cleans dishes and 
            leaves dishes.
          </p>
        </solution>
      </exercise>

      <p>
        What we think of as random processes are not necessarily random, but they may just be too difficult 
        to understand exactly. The fourth example in the solution to <xref ref="ex-random-process"/> suggests 
        a roommate's behavior is a random process. However, even if a roommate's behavior is not truly random, 
        modeling her behavior as a random process can still be useful.
      </p>
    </subsection>

    <subsection xml:id="subsec-disjoint-outcomes">
      <title>Disjoint or mutually exclusive outcomes</title>
      
      <p>
        Two outcomes are called <term>disjoint</term> or <term>mutually exclusive</term> if they cannot both 
        happen. For instance, if we roll a die, the outcomes 1 and 2 are disjoint since they cannot both occur. 
        On the other hand, the outcomes 1 and <q>rolling an odd number</q> are not disjoint since both occur 
        if the outcome of the roll is a 1. The terms <em>disjoint</em> and <em>mutually exclusive</em> are 
        equivalent and interchangeable.
      </p>

      <p>
        Calculating the probability of disjoint outcomes is easy. When rolling a die, the outcomes 1 and 2 are 
        disjoint, and we compute the probability that one of these outcomes will occur by adding their separate 
        probabilities:
        <md>
          <mrow>P(\text{1 or 2}) \amp = P(\text{1}) + P(\text{2})</mrow>
          <mrow>\amp = 1/6 + 1/6 = 1/3</mrow>
        </md>
        What about the probability of rolling a 1, 2, 3, 4, 5, or 6? Here again, all of the outcomes are 
        disjoint so we add the probabilities:
        <md>
          <mrow>P(\text{1 or 2 or 3 or 4 or 5 or 6}) \amp = P(\text{1})+P(\text{2})+P(\text{3})+P(\text{4})+P(\text{5})+P(\text{6})</mrow>
          <mrow>\amp = 1/6 + 1/6 + 1/6 + 1/6 + 1/6 + 1/6 = 1</mrow>
        </md>
        The <term>Addition Rule</term> guarantees the accuracy of this approach when the outcomes are disjoint.
      </p>

      <assemblage>
        <title>Addition Rule of disjoint outcomes</title>
        <p>
          If <m>A_1</m> and <m>A_2</m> represent two disjoint outcomes, then the probability that one of 
          them occurs is given by
          <me>P(A_1\text{ or } A_2) = P(A_1) + P(A_2)</me>
          If there are many disjoint outcomes <m>A_1</m>, <ellipsis />, <m>A_k</m>, then the probability 
          that one of these outcomes will occur is
          <me>P(A_1) + P(A_2) + \cdots + P(A_k)</me>
        </p>
      </assemblage>

      <exercise xml:id="ex-disjoint-145">
        <statement>
          <p>
            We are interested in the probability of rolling a 1, 4, or 5. (a) Explain why the outcomes 1, 4, 
            and 5 are disjoint. (b) Apply the Addition Rule for disjoint outcomes to determine 
            <m>P(\text{1 or 4 or 5})</m>.
          </p>
        </statement>
        <solution>
          <p>
            (a) The random process is a die roll, and at most one of these outcomes can come up. This means 
            they are disjoint outcomes. (b) <m>P(\text{1 or 4 or 5}) = P(\text{1})+P(\text{4})+P(\text{5}) = \frac{1}{6} + \frac{1}{6} + \frac{1}{6} = \frac{3}{6} = \frac{1}{2}</m>
          </p>
        </solution>
      </exercise>

      <exercise xml:id="ex-loans-homeownership">
        <statement>
          <p>
            In the loans data set in Chapter 2, the homeownership variable described whether the borrower 
            rents, has a mortgage, or owns her property. Of the 10,000 borrowers, 3858 rented, 4789 had a 
            mortgage, and 1353 owned their home.
          </p>
          <p>
            <ol>
              <li>
                Are the outcomes rent, mortgage, and own disjoint?
              </li>
              <li>
                Determine the proportion of loans with value mortgage and own separately.
              </li>
              <li>
                Use the Addition Rule for disjoint outcomes to compute the probability a randomly selected 
                loan from the data set is for someone who has a mortgage or owns her home.
              </li>
            </ol>
          </p>
        </statement>
        <solution>
          <p>
            (a) Yes. Each loan is categorized in only one level of homeownership. 
            (b) Mortgage: <m>\frac{4789}{10000} = 0.479</m>. Own: <m>\frac{1353}{10000} = 0.135</m>. 
            (c) <m>P(\text{mortgage or own}) = P(\text{mortgage}) + P(\text{own}) = 0.479 + 0.135 = 0.614</m>.
          </p>
        </solution>
      </exercise>

      <p>
        Data scientists rarely work with individual outcomes and instead consider <term>sets</term> or 
        <term>collections</term> of outcomes. Let <m>A</m> represent the event where a die roll results in 
        1 or 2 and <m>B</m> represent the event that the die roll is a 4 or a 6. We write <m>A</m> as the 
        set of outcomes <m>\{1, 2\}</m> and <m>B=\{4, 6\}</m>. These sets are commonly called <term>events</term>. 
        Because <m>A</m> and <m>B</m> have no elements in common, they are disjoint events. <m>A</m> and 
        <m>B</m> are represented in <xref ref="fig-disjoint-sets"/>.
      </p>

      <figure xml:id="fig-disjoint-sets">
        <caption>
          Three events, <m>A</m>, <m>B</m>, and <m>D</m>, consist of outcomes from rolling a die. <m>A</m> 
          and <m>B</m> are disjoint since they do not have any outcomes in common.
        </caption>
        <image source="ch_probability/figures/disjointSets"/>
      </figure>

      <p>
        The Addition Rule applies to both disjoint outcomes and disjoint events. The probability that one of 
        the disjoint events <m>A</m> or <m>B</m> occurs is the sum of the separate probabilities:
        <me>P(A\text{ or }B) = P(A) + P(B) = 1/3 + 1/3 = 2/3</me>
      </p>

      <exercise xml:id="ex-verify-prob-a-b">
        <statement>
          <p>
            (a) Verify the probability of event <m>A</m>, <m>P(A)</m>, is <m>1/3</m> using the Addition Rule.
            (b) Do the same for event <m>B</m>.
          </p>
        </statement>
        <solution>
          <p>
            (a) <m>P(A) = P(\text{1 or 2}) = P(\text{1}) + P(\text{2}) = \frac{1}{6} + \frac{1}{6} = \frac{2}{6} = \frac{1}{3}</m>. 
            (b) Similarly, <m>P(B) = 1/3</m>.
          </p>
        </solution>
      </exercise>

      <exercise xml:id="ex-examining-disjoint-sets-abd">
        <statement>
          <p>
            (a) Using <xref ref="fig-disjoint-sets"/> as a reference, what outcomes are represented by event <m>D</m>? 
            (b) Are events <m>B</m> and <m>D</m> disjoint? 
            (c) Are events <m>A</m> and <m>D</m> disjoint?
          </p>
        </statement>
        <solution>
          <p>
            (a) Outcomes 2 and 3. 
            (b) Yes, events <m>B</m> and <m>D</m> are disjoint because they share no outcomes. 
            (c) The events <m>A</m> and <m>D</m> share an outcome in common, 2, and so are not disjoint.
          </p>
        </solution>
      </exercise>

      <exercise xml:id="ex-prob-b-or-d">
        <statement>
          <p>
            In <xref ref="ex-examining-disjoint-sets-abd"/>, you confirmed <m>B</m> and <m>D</m> from 
            <xref ref="fig-disjoint-sets"/> are disjoint. Compute the probability that event <m>B</m> or 
            event <m>D</m> occurs.
          </p>
        </statement>
        <solution>
          <p>
            Since <m>B</m> and <m>D</m> are disjoint events, use the Addition Rule: 
            <m>P(B \text{ or } D) = P(B) + P(D) = \frac{1}{3} + \frac{1}{3} = \frac{2}{3}</m>.
          </p>
        </solution>
      </exercise>
    </subsection>

    <subsection xml:id="subsec-probabilities-not-disjoint">
      <title>Probabilities when events are not disjoint</title>
      
      <p>
        Let's consider calculations for two events that are not disjoint in the context of a regular deck 
        of 52 cards, represented in <xref ref="fig-deck-of-cards"/>. If you are unfamiliar with the cards 
        in a regular deck, please see the footnote.<fn>The 52 cards are split into four suits: clubs, 
        diamonds, hearts, and spades. Each suit has its 13 cards labeled: 2, 3, <ellipsis />, 10, J (jack), 
        Q (queen), K (king), and A (ace). Thus, each card is a unique combination of a suit and a label, 
        e.g. 4 of hearts and jack of clubs. The 12 cards represented by the jacks, queens, and kings are 
        called face cards. The cards that are diamonds or hearts are typically colored red while the other 
        two suits are typically colored black.</fn>
      </p>

      <figure xml:id="fig-deck-of-cards">
        <caption>Representations of the 52 unique cards in a deck.</caption>
        <image source="ch_probability/figures/deckOfCards"/>
      </figure>

      <exercise xml:id="ex-prob-diamond-face">
        <statement>
          <p>
            (a) What is the probability that a randomly selected card is a diamond? 
            (b) What is the probability that a randomly selected card is a face card?
          </p>
        </statement>
        <solution>
          <p>
            (a) There are 52 cards and 13 diamonds. If the cards are thoroughly shuffled, each card has an 
            equal chance of being drawn, so the probability that a randomly selected card is a diamond is 
            <m>P(\diamondsuit) = \frac{13}{52} = 0.250</m>. 
            (b) Likewise, there are 12 face cards, so <m>P(\text{face card}) = \frac{12}{52} = \frac{3}{13} = 0.231</m>.
          </p>
        </solution>
      </exercise>

      <p>
        <term>Venn diagrams</term> are useful when outcomes can be categorized as <q>in</q> or <q>out</q> 
        for two or three variables, attributes, or random processes. The Venn diagram in 
        <xref ref="fig-cards-diamond-face-venn"/> uses a circle to represent diamonds and another to represent 
        face cards. If a card is both a diamond and a face card, it falls into the intersection of the circles. 
        If it is a diamond but not a face card, it will be in part of the left circle that is not in the right 
        circle (and so on). The total number of cards that are diamonds is given by the total number of cards 
        in the diamonds circle: <m>10+3=13</m>. The probabilities are also shown (e.g. <m>10/52 = 0.1923</m>).
      </p>

      <figure xml:id="fig-cards-diamond-face-venn">
        <caption>A Venn diagram for diamonds and face cards.</caption>
        <image source="ch_probability/figures/cardsDiamondFaceVenn"/>
      </figure>

      <p>
        Let <m>A</m> represent the event that a randomly selected card is a diamond and <m>B</m> represent 
        the event that it is a face card. How do we compute <m>P(A \text{ or } B)</m>? Events <m>A</m> and 
        <m>B</m> are not disjoint <mdash/> the cards jack of diamonds, queen of diamonds, and king of diamonds 
        fall into both categories <mdash/> so we cannot use the Addition Rule for disjoint events. Instead we 
        use the Venn diagram. We start by adding the probabilities of the two events:
        <me>P(A) + P(B) = P(\diamondsuit) + P(\text{face card}) = 13/52 + 12/52</me>
        However, the three cards that are in both events were counted twice, once in each probability. We must 
        correct this double counting:
        <md>
          <mrow>P(A\text{ or } B) \amp = P(\diamondsuit\text{ or face card})</mrow>
          <mrow>\amp = P(\diamondsuit) + P(\text{face card}) - P(\diamondsuit\text{ and face card})</mrow>
          <mrow>\amp = 13/52 + 12/52 - 3/52</mrow>
          <mrow>\amp = 22/52 = 11/26</mrow>
        </md>
        This equation is an example of the <term>General Addition Rule</term>.
      </p>

      <assemblage>
        <title>General Addition Rule</title>
        <p>
          If <m>A</m> and <m>B</m> are any two events, disjoint or not, then the probability that at least 
          one of them will occur is
          <me>P(A\text{ or }B) = P(A) + P(B) - P(A\text{ and }B)</me>
          where <m>P(A \text{ and } B)</m> is the probability that both events occur.
        </p>
      </assemblage>

      <note>
        <title><q>or</q> is inclusive</title>
        <p>
          When we write <q>or</q> in statistics, we mean <q>and/or</q> unless we explicitly state otherwise. 
          Thus, <m>A</m> or <m>B</m> occurs means <m>A</m>, <m>B</m>, or both <m>A</m> and <m>B</m> occur.
        </p>
      </note>

      <exercise xml:id="ex-general-addition-rule-simplifies">
        <statement>
          <p>
            (a) If <m>A</m> and <m>B</m> are disjoint, describe why this implies <m>P(A \text{ and } B) = 0</m>. 
            (b) Using part (a), verify that the General Addition Rule simplifies to the simpler Addition Rule 
            for disjoint events if <m>A</m> and <m>B</m> are disjoint.
          </p>
        </statement>
        <solution>
          <p>
            (a) If <m>A</m> and <m>B</m> are disjoint, <m>A</m> and <m>B</m> can never occur simultaneously. 
            (b) If <m>A</m> and <m>B</m> are disjoint, then the last <m>P(A\text{ and }B)</m> term in the 
            General Addition Rule formula is 0 (see part (a)) and we are left with the Addition Rule for 
            disjoint events.
          </p>
        </solution>
      </exercise>

      <exercise xml:id="ex-email-spam-number-venn">
        <statement>
          <p>
            In the loans data set describing 10,000 loans, 1495 loans were from joint applications (e.g. a 
            couple applied together), 4789 applicants had a mortgage, and 950 had both of these characteristics. 
            Create a Venn diagram for this setup.
          </p>
        </statement>
        <solution>
          <p>
            Both the counts and corresponding probabilities (e.g. <m>3839/10000 = 0.384</m>) are shown. Notice 
            that the number of loans represented in the left circle corresponds to <m>3839 + 950 = 4789</m>, 
            and the number represented in the right circle is <m>950 + 545 = 1495</m>.
          </p>
          <figure>
            <image source="ch_probability/figures/loans_app_type_home_venn"/>
          </figure>
        </solution>
      </exercise>

      <exercise xml:id="ex-loans-joint-mortgage-prob">
        <statement>
          <p>
            (a) Use your Venn diagram from <xref ref="ex-email-spam-number-venn"/> to determine the probability 
            a randomly drawn loan from the loans data set is from a joint application where the couple had a mortgage.
            (b) What is the probability that the loan had either of these attributes?
          </p>
        </statement>
        <solution>
          <p>
            (a) The solution is represented by the intersection of the two circles: 0.095.
            (b) This is the sum of the three disjoint probabilities shown in the circles: 
            <m>0.384 + 0.095 + 0.055 = 0.534</m> (off by 0.001 due to a rounding error).
          </p>
        </solution>
      </exercise>
    </subsection>

    <subsection xml:id="subsec-probability-distributions">
      <title>Probability distributions</title>
      
      <p>
        A <term>probability distribution</term> is a table of all disjoint outcomes and their associated 
        probabilities. <xref ref="fig-dice-prob"/> shows the probability distribution for the sum of two dice.
      </p>

      <figure xml:id="fig-dice-prob">
        <caption>Probability distribution for the sum of two dice.</caption>
        <tabular>
          <row bottom="minor">
            <cell></cell>
            <cell></cell>
            <cell></cell>
            <cell></cell>
            <cell></cell>
            <cell></cell>
            <cell></cell>
            <cell></cell>
            <cell></cell>
            <cell></cell>
            <cell></cell>
            <cell></cell>
          </row>
          <row>
            <cell>Dice sum</cell>
            <cell>2</cell>
            <cell>3</cell>
            <cell>4</cell>
            <cell>5</cell>
            <cell>6</cell>
            <cell>7</cell>
            <cell>8</cell>
            <cell>9</cell>
            <cell>10</cell>
            <cell>11</cell>
            <cell>12</cell>
          </row>
          <row bottom="minor">
            <cell>Probability</cell>
            <cell><m>\frac{1}{36}</m></cell>
            <cell><m>\frac{2}{36}</m></cell>
            <cell><m>\frac{3}{36}</m></cell>
            <cell><m>\frac{4}{36}</m></cell>
            <cell><m>\frac{5}{36}</m></cell>
            <cell><m>\frac{6}{36}</m></cell>
            <cell><m>\frac{5}{36}</m></cell>
            <cell><m>\frac{4}{36}</m></cell>
            <cell><m>\frac{3}{36}</m></cell>
            <cell><m>\frac{2}{36}</m></cell>
            <cell><m>\frac{1}{36}</m></cell>
          </row>
        </tabular>
      </figure>

      <assemblage>
        <title>Rules for probability distributions</title>
        <p>
          A probability distribution is a list of the possible outcomes with corresponding probabilities that 
          satisfies three rules:
        </p>
        <p>
          <ol>
            <li>The outcomes listed must be disjoint.</li>
            <li>Each probability must be between 0 and 1.</li>
            <li>The probabilities must total 1.</li>
          </ol>
        </p>
      </assemblage>

      <exercise xml:id="ex-us-household-income-dists">
        <statement>
          <p>
            <xref ref="fig-us-household-income-dists"/> suggests three distributions for household income in 
            the United States. Only one is correct. Which one must it be? What is wrong with the other two?
          </p>
        </statement>
        <solution>
          <p>
            The probabilities of (a) do not sum to 1. The second probability in (b) is negative. This leaves (c), 
            which sure enough satisfies the requirements of a distribution. One of the three was said to be the 
            actual distribution of US household incomes, so it must be (c).
          </p>
        </solution>
      </exercise>

      <figure xml:id="fig-us-household-income-dists">
        <caption>Proposed distributions of US household incomes.</caption>
        <tabular>
          <row bottom="minor">
            <cell>Income Range</cell>
            <cell>$0-25k</cell>
            <cell>$25k-50k</cell>
            <cell>$50k-100k</cell>
            <cell>$100k+</cell>
          </row>
          <row>
            <cell>(a)</cell>
            <cell>0.18</cell>
            <cell>0.39</cell>
            <cell>0.33</cell>
            <cell>0.16</cell>
          </row>
          <row>
            <cell>(b)</cell>
            <cell>0.38</cell>
            <cell>-0.27</cell>
            <cell>0.52</cell>
            <cell>0.37</cell>
          </row>
          <row bottom="minor">
            <cell>(c)</cell>
            <cell>0.28</cell>
            <cell>0.27</cell>
            <cell>0.29</cell>
            <cell>0.16</cell>
          </row>
        </tabular>
      </figure>

      <p>
        Chapter 1 emphasized the importance of plotting data to provide quick summaries. Probability distributions 
        can also be summarized in a bar plot. For instance, the distribution of US household incomes is shown in 
        <xref ref="fig-us-household-income-dist-bar"/> as a bar plot. The probability distribution for the sum of 
        two dice is shown in <xref ref="fig-dice-prob"/> and plotted in <xref ref="fig-dice-sum-dist"/>.
      </p>

      <figure xml:id="fig-us-household-income-dist-bar">
        <caption>The probability distribution of US household income.</caption>
        <image source="ch_probability/figures/usHouseholdIncomeDistBar"/>
      </figure>

      <figure xml:id="fig-dice-sum-dist">
        <caption>The probability distribution of the sum of two dice.</caption>
        <image source="ch_probability/figures/diceSumDist"/>
      </figure>

      <p>
        In these bar plots, the bar heights represent the probabilities of outcomes. If the outcomes are numerical 
        and discrete, it is usually (visually) convenient to make a bar plot that resembles a histogram, as in the 
        case of the sum of two dice. Another example of plotting the bars at their respective locations is shown 
        in <xref ref="fig-book-cost-dist"/>.
      </p>
    </subsection>

    <subsection xml:id="subsec-complement">
      <title>Complement of an event</title>
      
      <p>
        Rolling a die produces a value in the set <m>\{1, 2, 3, 4, 5, 6\}</m>. This set of all possible outcomes 
        is called the <term>sample space</term> (<m>S</m>) for rolling a die. We often use the sample space to 
        examine the scenario where an event does not occur.
      </p>

      <p>
        Let <m>D=\{2, 3\}</m> represent the event that the outcome of a die roll is 2 or 3. Then the 
        <term>complement</term> of <m>D</m> represents all outcomes in our sample space that are not in <m>D</m>, 
        which is denoted by <m>D^c = \{1, 4, 5, 6\}</m>. That is, <m>D^c</m> is the set of all possible outcomes 
        not already included in <m>D</m>. <xref ref="fig-complement-of-d"/> shows the relationship between <m>D</m>, 
        <m>D^c</m>, and the sample space <m>S</m>.
      </p>

      <figure xml:id="fig-complement-of-d">
        <caption>
          Event <m>D=\{2, 3\}</m> and its complement, <m>D^c = \{1, 4, 5, 6\}</m>. <m>S</m> represents the 
          sample space, which is the set of all possible outcomes.
        </caption>
        <image source="ch_probability/figures/complementOfD"/>
      </figure>

      <exercise xml:id="ex-complement-prob">
        <statement>
          <p>
            (a) Compute <m>P(D^c) = P(\text{rolling a 1, 4, 5, or 6})</m>. 
            (b) What is <m>P(D) + P(D^c)</m>?
          </p>
        </statement>
        <solution>
          <p>
            (a) The outcomes are disjoint and each has probability <m>1/6</m>, so the total probability is 
            <m>4/6=2/3</m>. 
            (b) We can also see that <m>P(D)=\frac{1}{6} + \frac{1}{6} = 1/3</m>. Since <m>D</m> and <m>D^c</m> 
            are disjoint, <m>P(D) + P(D^c) = 1</m>.
          </p>
        </solution>
      </exercise>

      <exercise xml:id="ex-complement-ab">
        <statement>
          <p>
            Events <m>A=\{1, 2\}</m> and <m>B=\{4, 6\}</m> are shown in <xref ref="fig-disjoint-sets"/>. 
            (a) Write out what <m>A^c</m> and <m>B^c</m> represent. 
            (b) Compute <m>P(A^c)</m> and <m>P(B^c)</m>. 
            (c) Compute <m>P(A)+P(A^c)</m> and <m>P(B)+P(B^c)</m>.
          </p>
        </statement>
        <solution>
          <p>
            Brief solutions: (a) <m>A^c=\{3, 4, 5, 6\}</m> and <m>B^c=\{1, 2, 3, 5\}</m>. 
            (b) Noting that each outcome is disjoint, add the individual outcome probabilities to get 
            <m>P(A^c)=2/3</m> and <m>P(B^c)=2/3</m>. 
            (c) <m>A</m> and <m>A^c</m> are disjoint, and the same is true of <m>B</m> and <m>B^c</m>. 
            Therefore, <m>P(A) + P(A^c) = 1</m> and <m>P(B) + P(B^c) = 1</m>.
          </p>
        </solution>
      </exercise>

      <p>
        A complement of an event <m>A</m> is constructed to have two very important properties: (i) every possible 
        outcome not in <m>A</m> is in <m>A^c</m>, and (ii) <m>A</m> and <m>A^c</m> are disjoint. Property (i) implies
        <me>P(A\text{ or }A^c) = 1</me>
        That is, if the outcome is not in <m>A</m>, it must be represented in <m>A^c</m>. We use the Addition Rule 
        for disjoint events to apply Property (ii):
        <me>P(A\text{ or }A^c) = P(A) + P(A^c)</me>
        Combining the last two equations yields a very useful relationship between the probability of an event and 
        its complement.
      </p>

      <assemblage>
        <title>Complement</title>
        <p>
          The complement of event <m>A</m> is denoted <m>A^c</m>, and <m>A^c</m> represents all outcomes not in <m>A</m>. 
          <m>A</m> and <m>A^c</m> are mathematically related:
          <me>P(A) + P(A^c) = 1, \quad\text{i.e.}\quad P(A) = 1-P(A^c)</me>
        </p>
      </assemblage>

      <p>
        In simple examples, computing <m>A</m> or <m>A^c</m> is feasible in a few steps. However, using the 
        complement can save a lot of time as problems grow in complexity.
      </p>

      <exercise xml:id="ex-dice-less-than-12">
        <statement>
          <p>
            Let <m>A</m> represent the event where we roll two dice and their total is less than 12. 
            (a) What does the event <m>A^c</m> represent? 
            (b) Determine <m>P(A^c)</m> from <xref ref="fig-dice-prob"/>. 
            (c) Determine <m>P(A)</m>.
          </p>
        </statement>
        <solution>
          <p>
            (a) The complement of <m>A</m>: when the total is equal to 12. 
            (b) <m>P(A^c) = 1/36</m>. 
            (c) Use the probability of the complement from part (b), <m>P(A^c) = 1/36</m>, and the equation for 
            the complement: <m>P(\text{less than 12}) = 1 - P(\text{12}) = 1 - 1/36 = 35/36</m>.
          </p>
        </solution>
      </exercise>

      <exercise xml:id="ex-dice-complement-probs">
        <statement>
          <p>
            Find the following probabilities for rolling two dice:
          </p>
          <p>
            <ol>
              <li>The sum of the dice is <em>not</em> 6.</li>
              <li>The sum is at least 4. That is, determine the probability of the event <m>B = \{4, 5, \ldots, 12\}</m>.</li>
              <li>The sum is no more than 10. That is, determine the probability of the event <m>D=\{2, 3, \ldots, 10\}</m>.</li>
            </ol>
          </p>
        </statement>
        <solution>
          <p>
            (a) First find <m>P(6)=5/36</m>, then use the complement: <m>P(\text{not 6}) = 1 - P(6) = 31/36</m>.
          </p>
          <p>
            (b) First find the complement, which requires much less effort: <m>P(\text{2 or 3})=1/36+2/36=1/12</m>. 
            Then calculate <m>P(B) = 1-P(B^c) = 1-1/12 = 11/12</m>.
          </p>
          <p>
            (c) As before, finding the complement is the clever way to determine <m>P(D)</m>. First find 
            <m>P(D^c) = P(\text{11 or 12})=2/36 + 1/36=1/12</m>. Then calculate <m>P(D) = 1 - P(D^c) = 11/12</m>.
          </p>
        </solution>
      </exercise>
    </subsection>

    <subsection xml:id="subsec-independence">
      <title>Independence</title>
      
      <p>
        Just as variables and observations can be independent, random processes can be independent, too. Two 
        processes are <term>independent</term> if knowing the outcome of one provides no useful information 
        about the outcome of the other. For instance, flipping a coin and rolling a die are two independent 
        processes <mdash/> knowing the coin was heads does not help determine the outcome of a die roll. On 
        the other hand, stock prices usually move up or down together, so they are not independent.
      </p>

      <p>
        <xref ref="ex-prob-of-2-ones"/> provides a basic example of two independent processes: rolling two dice. 
        We want to determine the probability that both will be 1. Suppose one of the dice is red and the other 
        white. If the outcome of the red die is a 1, it provides no information about the outcome of the white 
        die. We first encountered this same question in <xref ref="ex-prob-of-2-ones"/>, where we calculated 
        the probability using the following reasoning: <m>1/6</m> of the time the red die is a 1, and <m>1/6</m> 
        of <em>those</em> times the white die will also be 1. This is illustrated in <xref ref="fig-indep-for-rolling-two-1s"/>. 
        Because the rolls are independent, the probabilities of the corresponding outcomes can be multiplied to 
        get the final answer: <m>(1/6)\times(1/6)=1/36</m>. This can be generalized to many independent processes.
      </p>

      <figure xml:id="fig-indep-for-rolling-two-1s">
        <caption>
          <m>1/6</m> of the time, the first roll is a 1. Then <m>1/6</m> of <em>those</em> times, the second 
          roll will also be a 1.
        </caption>
        <image source="ch_probability/figures/indepForRollingTwo1s"/>
      </figure>

      <example xml:id="ex-three-dice">
        <title>Probability of three 1s</title>
        <statement>
          <p>
            What if there was also a blue die independent of the other two? What is the probability of rolling 
            the three dice and getting all 1s?
          </p>
        </statement>
        <solution>
          <p>
            The same logic applies from <xref ref="ex-prob-of-2-ones"/>. If <m>1/36</m> of the time the white 
            and red dice are both 1, then <m>1/6</m> of <em>those</em> times the blue die will also be 1, so 
            multiply:
            <md>
              <mrow>P(\text{white}=1 \text{ and } \text{red}=1 \text{ and } \text{blue}=1) \amp = P(\text{white}=1)\times P(\text{red}=1)\times P(\text{blue}=1)</mrow>
              <mrow>\amp = (1/6)\times (1/6)\times (1/6) = 1/216</mrow>
            </md>
          </p>
        </solution>
      </example>

      <p>
        <xref ref="ex-three-dice"/> illustrates what is called the Multiplication Rule for independent processes.
      </p>

      <assemblage>
        <title>Multiplication Rule for independent processes</title>
        <p>
          If <m>A</m> and <m>B</m> represent events from two different and independent processes, then the 
          probability that both <m>A</m> and <m>B</m> occur can be calculated as the product of their separate 
          probabilities:
          <me>P(A \text{ and }B) = P(A) \times P(B)</me>
          Similarly, if there are <m>k</m> events <m>A_1</m>, <ellipsis />, <m>A_k</m> from <m>k</m> independent 
          processes, then the probability they all occur is
          <me>P(A_1) \times P(A_2)\times \cdots \times P(A_k)</me>
        </p>
      </assemblage>

      <exercise xml:id="ex-2-handedness">
        <statement>
          <p>
            About 9% of people are left-handed. Suppose 2 people are selected at random from the U.S. population. 
            Because the sample size of 2 is very small relative to the population, it is reasonable to assume 
            these two people are independent. 
            (a) What is the probability that both are left-handed? 
            (b) What is the probability that both are right-handed?
          </p>
        </statement>
        <solution>
          <p>
            (a) The probability the first person is left-handed is 0.09, which is the same for the second person. 
            We apply the Multiplication Rule for independent processes to determine the probability that both will 
            be left-handed: <m>0.09\times 0.09 = 0.0081</m>.
          </p>
          <p>
            (b) It is reasonable to assume the proportion of people who are ambidextrous (both right- and left-handed) 
            is nearly 0, which results in <m>P(\text{right-handed})=1-0.09=0.91</m>. Using the same reasoning as 
            in part (a), the probability that both will be right-handed is <m>0.91\times 0.91 = 0.8281</m>.
          </p>
        </solution>
      </exercise>

      <exercise xml:id="ex-5-handedness">
        <statement>
          <p>
            Suppose 5 people are selected at random.
          </p>
          <p>
            <ol>
              <li>What is the probability that all are right-handed?</li>
              <li>What is the probability that all are left-handed?</li>
              <li>What is the probability that not all of the people are right-handed?</li>
            </ol>
          </p>
        </statement>
        <solution>
          <p>
            (a) The abbreviations RH and LH are used for right-handed and left-handed, respectively. Since each 
            are independent, we apply the Multiplication Rule for independent processes:
            <md>
              <mrow>P(\text{all five are RH}) \amp = P(\text{first = RH, second = RH, \ldots, fifth = RH})</mrow>
              <mrow>\amp = P(\text{first = RH})\times P(\text{second = RH})\times \cdots \times P(\text{fifth = RH})</mrow>
              <mrow>\amp = 0.91\times 0.91\times 0.91\times 0.91\times 0.91 = 0.624</mrow>
            </md>
          </p>
          <p>
            (b) Using the same reasoning as in (a), <m>0.09\times 0.09\times 0.09\times 0.09\times 0.09 = 0.0000059</m>
          </p>
          <p>
            (c) Use the complement, <m>P(\text{all five are RH})</m>, to answer this question:
            <me>P(\text{not all RH}) = 1 - P(\text{all RH}) = 1 - 0.624 = 0.376</me>
          </p>
        </solution>
      </exercise>

      <p>
        Suppose the variables handedness and sex are independent, i.e. knowing someone's sex provides no useful 
        information about their handedness and vice-versa. Then we can compute whether a randomly selected person 
        is right-handed and female<fn>The actual proportion of the U.S. population that is female is about 50%, 
        and so we use 0.5 for the probability of sampling a woman. However, this probability does differ in other 
        countries.</fn> using the Multiplication Rule:
        <md>
          <mrow>P(\text{right-handed and female}) \amp = P(\text{right-handed}) \times P(\text{female})</mrow>
          <mrow>\amp = 0.91 \times 0.50 = 0.455</mrow>
        </md>
      </p>

      <exercise xml:id="ex-three-people-gender-handedness">
        <statement>
          <p>
            Three people are selected at random.
          </p>
          <p>
            <ol>
              <li>What is the probability that the first person is male and right-handed?</li>
              <li>What is the probability that the first two people are male and right-handed?</li>
              <li>What is the probability that the third person is female and left-handed?</li>
              <li>What is the probability that the first two people are male and right-handed and the third person is female and left-handed?</li>
            </ol>
          </p>
        </statement>
        <solution>
          <p>
            Brief answers are provided. (a) This can be written in probability notation as 
            <m>P(\text{a randomly selected person is male and right-handed})=0.455</m>. 
            (b) 0.207. 
            (c) 0.045. 
            (d) 0.0093.
          </p>
        </solution>
      </exercise>

      <p>
        Sometimes we wonder if one outcome provides useful information about another outcome. The question we are 
        asking is, are the occurrences of the two events independent? We say that two events <m>A</m> and <m>B</m> 
        are independent if they satisfy <m>P(A \text{ and }B) = P(A) \times P(B)</m>.
      </p>

      <example xml:id="ex-heart-ace-independence">
        <title>Are heart and ace independent?</title>
        <statement>
          <p>
            If we shuffle up a deck of cards and draw one, is the event that the card is a heart independent of 
            the event that the card is an ace?
          </p>
        </statement>
        <solution>
          <p>
            The probability the card is a heart is <m>1/4</m> and the probability that it is an ace is <m>1/13</m>. 
            The probability the card is the ace of hearts is <m>1/52</m>. We check whether 
            <m>P(A \text{ and }B) = P(A) \times P(B)</m> is satisfied:
            <me>P(\heartsuit)\times P(\text{ace}) = \frac{1}{4}\times \frac{1}{13} = \frac{1}{52} = P(\heartsuit\text{ and ace})</me>
            Because the equation holds, the event that the card is a heart and the event that the card is an ace 
            are independent events.
          </p>
        </solution>
      </example>
    </subsection>
  </section>

</chapter>
