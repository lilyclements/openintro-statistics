<?xml version="1.0" encoding="UTF-8" ?>

<chapter xml:id="ch-simple-linear-regression" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Introduction to linear regression</title>

  <introduction>
    <p>Linear regression is a very powerful statistical technique. Many people have some familiarity with regression just from reading the news, where straight lines are overlaid on scatterplots. Linear models can be used for prediction or to evaluate whether there is a linear relationship between two numerical variables.</p>
  </introduction>

  <section xml:id="linRegrForTwoVar">
    <title>Fitting a line, residuals, and correlation</title>

    <p>It's helpful to think deeply about the line fitting process. In this section, we define the form of a linear model, explore criteria for what makes a good fit, and introduce a new statistic called <em>correlation</em>.</p>
    <subsection xml:id="fitting_line_to_data_section">
      <title>Fitting a line to data</title>
      <me>y = 5 + 64.96 x</me>
      <p>Consider what a perfect linear relationship means: we know the exact value of <m>y</m> just by knowing the value of <m>x</m>. This is unrealistic in almost any natural process. For example, if we took family income (<m>x</m>), this value would provide some useful information about how much financial support a college may offer a prospective student (<m>y</m>). However, the prediction would be far from perfect, since other factors play a role in financial support beyond a family's finances.</p>
      <figure xml:id="perfLinearModel">
        <caption>A scatterplot with a straight line fit to the data are shown for the date December 28th, 2018. The horizontal axis is "Number of Target Corporation Stocks to Purchase" and the vertical axis is "Total Cost of the Shares Purchase". Twelve data points are shown that all fall exactly on a straight line with an equation of y equals 5 plus 64.96 times x. Because the cost is computed using a linear formula, this explains why the linear fit is perfect.</caption>
        <image source="ch_regr_simple_linear/figures/perfLinearModel"/>
      </figure>

      <p>Linear regression is the statistical method for fitting a line to data where the relationship between two variables, <m>x</m> and <m>y</m>, can be modeled by a straight line with some error:</p>
      <me>y = \beta_0 + \beta_1x + \varepsilon</me>
      <p>The values <m>\beta_0</m> and <m>\beta_1</m> represent the model's parameters (<m>\beta</m> is the Greek letter <em>beta</em>), and the error is represented by <m>\varepsilon</m> (the Greek letter <em>epsilon</em>). The parameters are estimated using data, and we write their point estimates as <m>b_0</m> and <m>b_1</m>. When we use <m>x</m> to predict <m>y</m>, we usually call <m>x</m> the explanatory or <term>predictor</term> variable, and we call <m>y</m> the response; we also often drop the <m>\epsilon</m> term when writing down the model since our main focus is often on the prediction of the average outcome.</p>
      <p>It is rare for all of the data to fall perfectly on a straight line. Instead, it's more common for data to appear as a <em>cloud of points</em>, such as those examples shown in <xref ref="imperfLinearModel"/>. In each case, the data fall around a straight line, even if none of the observations fall exactly on the line. The first plot shows a relatively strong downward linear trend, where the remaining variability in the data around the line is minor relative to the strength of the relationship between <m>x</m> and <m>y</m>. The second plot shows an upward trend that, while evident, is not as strong as the first. The last plot shows a very weak downward trend in the data, so slight we can hardly notice it. In each of these examples, we will have some uncertainty regarding our estimates of the model parameters, <m>\beta_0</m> and <m>\beta_1</m>. For instance, we might wonder, should we move the line up or down a little, or should we tilt it more or less? As we move forward in this chapter, we will learn about criteria for line-fitting, and we will also learn about the uncertainty associated with estimates of model parameters.</p>
      <figure xml:id="imperfLinearModel">
        <caption>Three scatterplots are shown. The first has data ranging from -50 to positive 50 on both the horizontal and vertical axes. The data start in the upper left corner of the plot and then move steadily down to the right corner. The second plot has the horizontal axis running from 500 to about 2,000 and the vertical axis from about 0 to 25,000. At the left side of the plot, the data are in the lower half of the plot, and the points generally are steadily higher as we move right, where most points near the right end of the plot are in the upper region of the plot. A upwards trending line has been fit to these points. The last plot runs from about -10 to positive 50 on the horizontal axis and about -200 to positive 400 on the vertical axis. The points are scattered broadly across the range, with only the slightest downward trend evident in the data. A trend line has been fit to this data, though it is nearly flat.</caption>
        <image source="ch_regr_simple_linear/figures/imperfLinearModel"/>
      </figure>

      <p>There are also cases where fitting a straight line to the data, even if there is a clear relationship between the variables, is not helpful. One such case is shown in <xref ref="notGoodAtAllForALinearModel"/> where there is a very clear relationship between the variables even though the trend is not linear. We discuss nonlinear trends in this chapter and the next, but details of fitting nonlinear models are saved for a later course.</p>
      <figure xml:id="notGoodAtAllForALinearModel">
        <caption>A linear model is not useful in a nonlinear set of data shown in this plot. The data are from an introductory physics experiment, where a ball is shot at many angles of inclination between 0 degrees and 90 degrees (represented by the horizontal axis), and the measured horizontal distance traveled by the ball before it hits the ground is shown in meters. The first point, at an angle of inclination of 0 hits the ground at 0 meters traveled. As the angle is increased, the ball travels further before it hits the ground until reaching a peak at 45 degrees angle of inclination, at which point it decreases again until we reach an angle of 90 degrees, at which point the ball again does not travel any horizontal distance before it hits the ground. For the data shown, the best fitting straight line is shown and is flat. This is a good example of why a straight line fit to data where there is curvature is often not useful.</caption>
        <image source="ch_regr_simple_linear/figures/notGoodAtAllForALinearModel"/>
      </figure>

  </subsection>

    <subsection>
      <title>Using linear regression to predict possum head lengths</title>
      <p>Brushtail possums are a marsupial that lives in Australia, and a photo of one is shown in <xref ref="brushtail_possum"/>. Researchers captured 104 of these animals and took body measurements before releasing the animals back into the wild. We consider two of these measurements: the total length of each possum, from head to tail, and the length of each possum's head.</p>
      <figure xml:id="brushtail_possum">
        <caption>The common brushtail possum of Australia.</caption>
        <image source="ch_regr_simple_linear/figures/brushtail_possum"/>
      </figure>

      <figure xml:id="scattHeadLTotalL">
        <caption>A scatterplot showing head length against total length for 104 brushtail possums, where the horizontal axis for total length runs from 75 centimeters to about 97 centimeters (2.5 to 3.3 feet) and the vertical axis for head length runs from about 82 millimeters up to about 104 millimeters (3 to 4 inches). For possums with a total length between 75 to 80 centimeters, there are three points shown, each with head lengths of about 85 millimeters. For possums with total length from 80 to 85 centimeters, most head lengths range from about 85 millimeters to 95 millimeters. For possums with total lengths from 85 to 90 centimeters, head lengths mostly lie between 90 millimeters and 97 millimeters. For possums with total lengths larger than 90 centimeters, the head lengths are mostly between 93 millimeters and 100 millimeters. The trend is evidently upward and approximately linear. A point representing a possum with head length 94.1mm and total length 89cm is highlighted (although not relevant for any other purpose than giving an example or reminder for how a point is read in a scatterplot).</caption>
        <image source="ch_regr_simple_linear/figures/scattHeadLTotalL"/>
      </figure>

      <p>We want to describe the relationship between the head length and total length variables in the possum data set using a line. In this example, we will use the total length as the predictor variable, <m>x</m>, to predict a possum's head length, <m>y</m>. We could fit the linear relationship by eye, as in <xref ref="scattHeadLTotalLLine"/>. The equation for this line is</p>
      <me>\hat{y} = 41 + 0.59x</me>
      <p>A "hat" on <m>y</m> is used to signify that this is an estimate. We can use this line to discuss properties of possums. For instance, the equation predicts a possum with a total length of 80 cm will have a head length of</p>
      <md>
        <mrow>\hat{y} = 41 + 0.59\times 80</mrow>
        <mrow>= 88.2 % mm</mrow>
      </md>
      <p>The estimate may be viewed as an average: the equation predicts that possums with a total length of 80 cm will have an average head length of 88.2 mm. Absent further information about an 80 cm possum, the prediction for head length that uses the average is a reasonable estimate.</p>
      <figure xml:id="scattHeadLTotalLLine">
      </figure>

      <example xml:id="">
        <!-- Incomplete: head length of a possum besides its length? -->
      <p>Perhaps the relationship would be a little different for male possums than female possums, or perhaps it would differ for possums from one region of Australia versus another region. In <xref ref="ch_regr_mult_and_log"/>, we'll learn about how we can include more than one predictor. Before we get there, we first need to better understand how to best build a simple linear model with one predictor.</p>
      </example>

  </subsection>

    <subsection>
      <title>Residuals</title>
      <me>\text{Data} = \text{Fit} + \text{Residual}</me>
      <p>Each observation will have a residual, and three of the residuals for the linear model we fit for the possum data is shown in <xref ref="scattHeadLTotalLLine"/>. If an observation is above the regression line, then its residual, the vertical distance from the observation to the line, is positive. Observations below the line have negative residuals. One goal in picking the right linear model is for these residuals to be as small as possible.</p>
      <p>Let's look closer at the three residuals featured in <xref ref="scattHeadLTotalLLine"/>. The observation marked by an "<m>\times</m>" has a small, negative residual of about -1; the observation marked by "<m>+</m>" has a large residual of about +7; and the observation marked by "<m>\triangle</m>" has a moderate residual of about -4. The size of a residual is usually discussed in terms of its absolute value. For example, the residual for "<m>\triangle</m>" is larger than that of "<m>\times</m>" because <m>|-4|</m> is larger than <m>|-1|</m>.</p>
      <assemblage>
        <title>Residual: difference between observed and expected</title>
        <p>The residual of the <m>i^{th}</m> observation <m>(x_i, y_i)</m> is the difference of the observed response (<m>y_i</m>) and the response we would predict based on the model fit (<m>\hat{y}_i</m>):</p>
        <me>e_i = y_i - \hat{y}_i</me>
        <p>We typically identify <m>\hat{y}_i</m> by plugging <m>x_i</m> into the model.</p>
      </assemblage>

      <example xml:id="">
        <title>The linear fit shown in Example</title>
        <p>Figure reference We first compute the predicted value of point "<m>\times</m>" based on the model:</p>
        <me>\hat{y}_{\times} = 41+0.59x_{\times} = 41+0.59\times 77.0 = 86.4</me>
        <p>Next we compute the difference of the actual head length and the predicted head length:</p>
        <me>e_{\times} = y_{\times} - \hat{y}_{\times} = 85.3 -  86.4 = -1.1</me>
        <p>The model's error is <m>e_{\times} = -1.1</m>mm, which is very close to the visual estimate of -1mm. The negative residual indicates that the linear model overpredicted head length for this particular possum.</p>
      </example>

      <p>(<m>+</m>) First compute the predicted value based on the model:</p>
      <me>\hat{y}_{+} = 41+0.59x_{+} = 41+0.59\times 85.0 = 91.15</me>
      <p>Then the residual is given by</p>
      <me>e_{+} = y_{+} - \hat{y}_{+} = 98.6-91.15=7.45</me>
      <p>This was close to the earlier estimate of 7.</p>
      <p>Residuals are helpful in evaluating how well a linear model fits a data set. We often display them in a <term>residual plot</term> such as the one shown in <xref ref="scattHeadLTotalLResidualPlot"/> for the regression line in <xref ref="scattHeadLTotalLLine"/>. The residuals are plotted at their original horizontal locations but with the vertical coordinate as the residual. For instance, the point <m>(85.0,98.6)_{+}</m> had a residual of 7.45, so in the residual plot it is placed at <m>(85.0, 7.45)</m>. Creating a residual plot is sort of like tipping the scatterplot over so the regression line is horizontal.</p>
      <figure xml:id="scattHeadLTotalLResidualPlot">
        <caption>A residual plot for the trend line fit to the brushtail possum data is shown. Here, the horizontal axis is the same – representing "total length", it spans 75 to 97 – while the vertical axis represents "Residuals" and spans from about -7 to positive 8. There is on evident trend in the residuals. Three points are specifically highlighted to reflect the three points discussed in the last figure. The first is labeled with an "X" with a total length of 77 and a residual of about -1. The second is labeled with a "plus sign" and has a total length of 85 and a residual of about 7. The last point highlighted is a "triangle" with a total length of about 95 and a residual of about -3. Note that the location of the residuals above and below the trend line reflects exactly with whether the residual is positive or negative, respectively.</caption>
        <image source="ch_regr_simple_linear/figures/scattHeadLTotalLResidualPlot"/>
      </figure>

      <example xml:id="">
        <p>characteristics or patterns still apparent in data after fitting a model. <xref ref="sampleLinesAndResPlots"/> shows three scatterplots with linear models in the first row and residual plots in the second row. Can you identify any patterns remaining in the residuals?}</p>
        <p>In the first data set (first column), the residuals show no obvious patterns. The residuals appear to be scattered randomly around the dashed line that represents 0.</p>
        <p>The second data set shows a pattern in the residuals. There is some curvature in the scatterplot, which is more obvious in the residual plot. We should not use a straight line to model these data. Instead, a more advanced technique should be used.</p>
        <p>The last plot shows very little upwards trend, and the residuals also show no obvious patterns. It is reasonable to try to fit a linear model to the data. However, it is unclear whether there is statistically significant evidence that the slope parameter is different from zero. The point estimate of the slope parameter, labeled <m>b_1</m>, is not zero, but we might wonder if this could just be due to chance. We will address this sort of scenario in <xref ref="inferenceForLinearRegression"/>.</p>
      </example>

      <figure xml:id="sampleLinesAndResPlots">
        <caption>Sample data with their best fitting lines (top row) and their corresponding residual plots (bottom row).</caption>
        <image source="ch_regr_simple_linear/figures/sampleLinesAndResPlots"/>
      </figure>

  </subsection>

    <subsection>
      <title>Describing linear relationships with correlation</title>
      <assemblage>
        <title>Correlation: strength of a linear relationship</title>
      </assemblage>

      <p>We can compute the correlation using a formula, just as we did with the sample mean and standard deviation. This formula is rather complex,\footnote{Formally, we can compute the correlation for observations <m>(x_1, y_1)</m>, <m>(x_2, y_2)</m>, ..., <m>(x_n, y_n)</m> using the formula</p>
      <me>R = \frac{1}{n-1} \sum_{i=1}^{n} \frac{x_i-\bar{x}}{s_x}\frac{y_i-\bar{y}}{s_y}</me>
      <p>where <m>\bar{x}</m>, <m>\bar{y}</m>, <m>s_x</m>, and <m>s_y</m> are the sample means and standard deviations for each variable.} and like with other statistics, we generally perform the calculations on a computer or calculator. <xref ref="posNegCorPlots"/> shows eight plots and their corresponding correlations. Only when the relationship is perfectly linear is the correlation either -1 or 1. If the relationship is strong and positive, the correlation will be near +1. If it is strong and negative, it will be near -1. If there is no apparent linear relationship between the variables, then the correlation will be near zero.</p>
      <figure xml:id="posNegCorPlots">
        <caption>Eight scatterplots are shown, each with their correlation noted. Each scatterplot appears to represent about 50 points. The first has a correlation of R equals 0.33, and there is a slight upward trend evident in the data – if a trend line were drawn for this data, much of the data would fall relatively far from the line. The second plot has a correlation of R equals 0.69, and a clearer upward trend is evident, but it is still pretty volatile with many points deviating far from where the trend line would be. The third plot has a correlation of 0.98, and the data show a very clear upward trend, where if a trend line were drawn, the data would be (relatively) quite close to this line. The fourth plot shows a correlation of R equals 1.00, and here the points appear exactly on a line with an upward trajectory. The fifth plot shows data with a correlation of R equals 0.08, where no trend is visually evident in the data. The sixth plot has a correlation of R equals -0.64, and a downward trend is evident in the data, but the individual observations would in many cases be pretty distant from any trend line fit to the data (on a relative basis). The seventh plot has a correlation of R equals -0.92 and shows data with a clear downward trend, where the data would deviate just a modest amount from a trend line fit to the data. The last plot shows a correlation of R equals -1, where the observations would fit exactly on a line trending downwards.</caption>
        <image source="ch_regr_simple_linear/figures/posNegCorPlots"/>
      </figure>

      <p>The correlation is intended to quantify the strength of a linear trend. Nonlinear trends, even when strong, sometimes produce correlations that do not reflect the strength of the relationship; see three such examples in <xref ref="corForNonLinearPlots"/>.</p>
      <figure xml:id="corForNonLinearPlots">
      </figure>

      <exercise xml:id="visualize_residuals">
        <title>Visualize the residuals</title>
        <statement>
          <p>The scatterplots shown below each have a superimposed regression line. If we were to construct a residual plot (residuals versus <m>x</m>) for each, describe what those plots would look like.    </p>
        </statement>
      </exercise>

      <exercise xml:id="trends_in_residuals">
        <title>Trends in the residuals</title>
        <statement>
          <p>Shown below are two plots of residuals remaining after fitting a linear model to two different sets of data. Describe important features and determine if a linear model would be appropriate for these data. Explain your reasoning.    </p>
        </statement>
      </exercise>

      <exercise xml:id="identify_relationships_1">
        <title>Identify relationships, Part I</title>
        <statement>
          <p>For each of the six plots, identify the strength of the relationship (e.g. weak, moderate, or strong) in the data and whether fitting a linear model would be reasonable.     %    </p>
        </statement>
      </exercise>

      <exercise xml:id="identify_relationships_2">
        <title>Identify relationships, Part II</title>
        <statement>
          <p>For each of the six plots, identify the strength of the relationship (e.g. weak, moderate, or strong) in the data and whether fitting a linear model would be reasonable.     %    </p>
        </statement>
      </exercise>

      <exercise xml:id="exams_grades_correlation">
        <title>Exams and grades</title>
        <statement>
          <p>The two scatterplots below show the relationship between final and mid-semester exam grades recorded during several years for a Statistics course at a university.  \item Based on these graphs, which of the two exams has the strongest correlation with the final exam grade? Explain. \item Can you think of a reason why the correlation between the exam you chose in part (a) and the final exam is higher?    %  </p>
        </statement>
      </exercise>

      <exercise xml:id="husbands_wives_correlation">
        <title>Husbands and wives, Part I</title>
        <statement>
          <p>The Great Britain Office of Population Census and Surveys once collected data on a random sample of 170 married couples in Britain, recording the age (in years) and heights (converted here to inches) of the husbands and wives. The scatterplot on the left shows the wife's age plotted against her husband's age, and the plot on the right shows wife's height plotted against husband's height.      \item Describe the relationship between husbands' and wives' ages. \item Describe the relationship between husbands' and wives' heights. \item Which plot shows a stronger correlation? Explain your reasoning. \item Data on heights were originally collected in centimeters, and then converted to inches. Does this conversion affect the correlation between husbands' and wives' heights? </p>
        </statement>
      </exercise>

      <exercise xml:id="match_corr_1">
        <title>Match the correlation, Part I</title>
        <statement>
          <p>Match each correlation to the corresponding scatterplot. %  \item <m>R = -0.7</m> \item <m>R = 0.45</m> \item <m>R = 0.06</m> \item <m>R = 0.92</m>  %    </p>
        </statement>
      </exercise>

      <exercise xml:id="match_corr_2">
        <title>Match the correlation, Part II</title>
        <statement>
          <p>Match each correlation to the corresponding scatterplot. %  \item <m>R = 0.49</m> \item <m>R = -0.48</m> \item <m>R = -0.03</m> \item <m>R = -0.85</m>  %    </p>
        </statement>
      </exercise>

      <exercise xml:id="speed_height_gender">
        <title>Speed and height</title>
        <statement>
          <p>1,302 UCLA students were asked to fill out a survey where they were asked about their height, fastest speed they have ever driven, and gender. The scatterplot on the left displays the relationship between height and fastest speed, and the scatterplot on the right displays the breakdown by gender in this relationship.   %    \item Describe the relationship between height and fastest speed. \item Why do you think these variables are positively associated? \item What role does gender play in the relationship between height and fastest driving speed? </p>
        </statement>
      </exercise>

      <exercise xml:id="guess_correlation">
        <title>Guess the correlation</title>
        <statement>
          <p>Eduardo and Rosie are both collecting data on number of rainy days in a year and the total rainfall for the year. Eduardo records rainfall in inches and Rosie in centimeters. How will their correlation coefficients compare?</p>
        </statement>
      </exercise>

      <exercise xml:id="coast_starlight_corr_units">
        <title>The Coast Starlight, Part I</title>
        <statement>
          <p>The Coast Starlight Amtrak train runs from Seattle to Los Angeles. The scatterplot below displays the distance between each stop (in miles) and the amount of time it takes to travel from one stop to another (in minutes). { \item Describe the relationship between distance and travel time. \item How would the relationship change if travel time was instead measured in hours, and distance was instead measured in kilometers? \item The correlation between travel time (in miles) and distance (in minutes) is <m>r = 0.636</m>. Suppose we had instead measured travel time in hours and measured distance in kilometers (km). What would be the correlation in these different units? } <m>\:</m>\\ </p>
        </statement>
      </exercise>

      <exercise xml:id="crawling_babies_corr_units">
        <title>Crawling babies, Part I</title>
        <statement>
          <p>A study conducted at the University of Denver investigated whether babies take longer to learn to crawl in cold months, when they are often bundled in clothes that restrict their movement, than in warmer months.  Infants born during the study year were split into twelve groups, one for each birth month. We consider the average crawling age of babies in each group against the average temperature when the babies are six months old (that's when babies often begin trying to crawl). Temperature is measured in degrees Fahrenheit ( F) and age is measured in weeks. { \item Describe the relationship between temperature and crawling age. \item How would the relationship change if temperature was measured in degrees Celsius ( C) and age was measured in months? \item The correlation between temperature in  F and age in weeks was <m>r=-0.70</m>. If we converted the temperature to  C and age to months, what would the correlation be? } <m>\:</m>\\ </p>
        </statement>
      </exercise>

      <exercise xml:id="body_measurements_shoulder_height_corr_units">
        <title>Body measurements, Part I</title>
        <statement>
          <p>Researchers studying anthropometry collected body girth measurements and skeletal diameter measurements, as well as age, weight, height and gender for 507 physically active individuals. The scatterplot below shows the relationship between height and shoulder girth (over deltoid muscles), both measured in centimeters. % { \item Describe the relationship between shoulder girth and height. \item How would the relationship change if shoulder girth was measured in inches while the units of height remained in centimeters? } <m>\:</m>\\ </p>
        </statement>
      </exercise>

      <exercise xml:id="body_measurements_hip_weight_corr_units">
        <title>Body measurements, Part II</title>
        <statement>
          <p>The scatterplot below shows the relationship between weight measured in kilograms and hip girth measured in centimeters from the data described in Exercise <xref ref="body_measurements_shoulder_height_corr_units"/>.% % { \item Describe the relationship between hip girth and weight. \item How would the relationship change if weight was measured in pounds while the units for hip girth remained in centimeters? } <m>\:</m>\\ </p>
        </statement>
      </exercise>

      <exercise xml:id="corr_husband_wife_age">
        <title>Correlation, Part I</title>
        <statement>
          <p>What would be the correlation between the ages of husbands and wives if men always married woman who were  \item 3 years younger than themselves? \item 2 years older than themselves? \item half as old as themselves? </p>
        </statement>
      </exercise>

      <exercise xml:id="corr_men_women_salary">
        <title>Correlation, Part II</title>
        <statement>
          <p>What would be the correlation between the annual salaries of males and females at a company if for a certain type of position men always made  \item \$5,000 more than women? \item 25 percent more than women? \item 15 percent less than women? </p>
        </statement>
      </exercise>

  </subsection>
  </section>

  <section xml:id="fittingALineByLSR">
    <title>Least squares regression</title>

    <p>Fitting linear models by eye is open to criticism since it is based on an individual's preference. In this section, we use <em>least squares regression</em> as a more rigorous approach.</p>
    <subsection>
      <title>Gift aid for freshman at Elmhurst College</title>
      <p>This section considers family income and gift aid data from a random sample of fifty students in the freshman class of Elmhurst College in Illinois. Gift aid is financial aid that does not need to be paid back, as opposed to a loan. A scatterplot of the data is shown in <xref ref="elmhurstScatterW2Lines"/> along with two linear fits. The lines follow a negative trend in the data; students who have higher family incomes tended to have lower gift aid from the university.</p>
      <figure xml:id="elmhurstScatterW2Lines">
      </figure>

  </subsection>

    <subsection>
      <title>An objective measure for finding the best line</title>
      <p>We begin by thinking about what we mean by "best". Mathematically, we want a line that has small residuals. The first option that may come to mind is to minimize the sum of the residual magnitudes:</p>
      <me>|e_1| + |e_2| + \dots + |e_n|</me>
      <p>which we could accomplish with a computer program. The resulting dashed line shown in <xref ref="elmhurstScatterW2Lines"/> demonstrates this fit can be quite reasonable. However, a more common practice is to choose the line that minimizes the sum of the squared residuals:</p>
      <me>e_{1}^2 + e_{2}^2 + \dots + e_{n}^2</me>
      <p>The line that minimizes this <term>least squares criterion</term> is represented as the solid line in <xref ref="elmhurstScatterW2Lines"/>. This is commonly called the <term>least squares line</term>. The following are three possible reasons to choose this option instead of trying to minimize the sum of residual magnitudes without any squaring:</p>
      <ol>
        <li>
          <p>It is the most commonly used method.</p>
        </li>
        <li>
          <p>Computing the least squares line is widely supported in statistical software.</p>
        </li>
        <li>
          <p>In many applications, a residual twice as large as another residual is more than twice as bad. For example, being off by 4 is usually more than twice as bad as being off by 2. Squaring the residuals accounts for this discrepancy.</p>
        </li>
      </ol>
      <p>The first two reasons are largely for tradition and convenience; the last reason explains why the least squares criterion is typically most helpful.\footnote{There are applications where the sum of residual magnitudes may be more useful, and there are plenty of other criteria we might consider. However, this book only applies the least squares criterion.}</p>
  </subsection>

    <subsection>
      <title>Conditions for the least squares line</title>
      <dl>
        <li>
          <title>Linearity.</title>
        <p>The data should show a linear trend. If there is a nonlinear trend (e.g. left panel of Figure~\ref{whatCanGoWrongWithLinearModel}), an advanced regression method from another book or later course should be applied.</p>
        </li>
        <li>
          <title>Nearly normal residuals.</title>
        <p>Generally, the residuals must be nearly normal. When this condition is found to be unreasonable, it is usually because of outliers or concerns about influential points, %    The theoretical condition is that the residuals %    must be normally distributed. %    The importance of this condition depends on a few factors: %    [(1)] %    \item %        Is there any interest in predicting the range of %        plausible values for individual observations? %        If yes, then normality is important. %    \item %        Are there very few observations, such as fewer than~30? %        If yes, then normality is important. %     %    If the answer is \emph{no} to each of these questions, %    then %    However, this condition can be taken with a grain of salt %    when primarily focused on the trend of the data. %    When the data's trend is the focus, %    the number of observations can be modest in number, %    such as 30 or more, at which point this condition %    can be somewhat relaxed. %    Generally, it is important to look for outliers, which we'll talk about more in Sections~\ref{typesOfOutliersInLinearRegression}. An example of a residual that would be a potentially concern is shown in Figure~\ref{whatCanGoWrongWithLinearModel}, where one observation is clearly much further from the regression line than the others.</p>
        </li>
        <li>
          <title>Constant variability.</title>
        <p>The variability of points around the least squares line remains roughly constant. An example of non-constant variability is shown in the third panel of Figure~\ref{whatCanGoWrongWithLinearModel}, which represents the most common pattern observed when this condition fails: the variability of $y$ is larger when $x$ is larger.</p>
        </li>
        <li>
          <title>Independent observations.</title>
        <p>Be cautious about applying regression to \term{time series} data, which are sequential observations in time such as a stock price each day. Such data may have an underlying structure that should be considered in a model and analysis. An example of a data set where successive observations are not independent is shown in the fourth panel of Figure~\ref{whatCanGoWrongWithLinearModel}. There are also other instances where correlations within the data are important, which is further discussed in Chapter~\ref{ch_regr_mult_and_log}.</p>
        </li>
      </dl>
      <figure xml:id="whatCanGoWrongWithLinearModel">
        <caption>Four scatterplots are shown, each with their own residual plot. These four examples show when methods in this chapter are insufficient to apply to the data. In the first set, a scatterplot with arch-shaped data is shown with a straight line fit to the data, which poorly fits the curved nature of the data; this is meant to highlight an example where "linearity" fails. In the second set, a set of data with a line fit is shown, where the data tightly pack around the line, except one point in particular that is far from the line and represents the case where there are "extreme outliers" in the data. The third set shows a case where a straight line fits the data, but the variability around the line changes, where observations tend to be quite close to the line on the left, but when looking further right, the observations tend to be increasingly far from the line, indicating "changing variability" in the residuals over different regions of the plot. The fourth set provides another case of what is called "time series" data, which is a context where "successive observations are correlated".</caption>
        <image source="ch_regr_simple_linear/figures/whatCanGoWrongWithLinearModel"/>
      </figure>

  </subsection>

    <subsection xml:id="findingTheLeastSquaresLineSection">
      <title>Finding the least squares line</title>
      <p>For the Elmhurst data, we could write the equation of the least squares regression line as</p>
      <me>\widehat{aid} = \beta_0 + \beta_{1}\times \textit{family\us{}income}</me>
      <p>Here the equation is set up to predict gift aid based on a student's family income, which would be useful to students considering Elmhurst. These two values, <m>\beta_0</m> and <m>\beta_1</m>, are the parameters of the regression line.</p>
      <p>As in Chapters <xref ref="ch_foundations_for_inf"/>, <xref ref="ch_inference_for_props"/>, and <xref ref="ch_inference_for_means"/>, the parameters are estimated using observed data. In practice, this estimation is done using a computer in the same way that other estimates, like a sample mean, can be estimated using a computer or calculator. However, we can also find the parameter estimates by applying two properties of the least squares line:</p>
      <ul>
        <li>
          <p>The slope of the least squares line can be estimated by</p>
        </li>
        <me>b_1 = \frac{s_y}{s_x} R</me>
        <p>where <m>R</m> is the correlation between the two variables, and <m>s_x</m> and <m>s_y</m> are the sample standard deviations of the explanatory variable and response, respectively.</p>
        <li>
          <p>If <m>\bar{x}</m> is the sample mean of the explanatory variable and <m>\bar{y}</m> is the sample mean of the vertical variable, then the point <m>(\bar{x}, \bar{y})</m> is on the least squares line.</p>
        </li>
      </ul>
      <p>Next, we formally find the point estimates <m>b_0</m> and <m>b_1</m> of the parameters <m>\beta_0</m> and <m>\beta_1</m>.</p>
      <figure xml:id="summaryStatsElmhurstRegr">
        <caption>Summary statistics for family income and gift aid.</caption>
      </figure>

      <p>Compute the slope using the summary statistics from <xref ref="summaryStatsElmhurstRegr"/>:</p>
      <me>b_1 = \frac{s_y}{s_x} R = \frac{\text{5,460}}{\text{63,200}}(-0.499) = -0.0431</me>
      <p>You might recall the <term>point-slope</term> form of a line from math class, which we can use to find the model fit, including the estimate of <m>b_0</m>. Given the slope of a line and a point on the line, <m>(x_0, y_0)</m>, the equation for the line can be written as</p>
      <me>y - y_0 = slope\times (x - x_0)</me>
      <assemblage>
        <title>Identifying the least squares line from summary statistics</title>
        <p>To identify the least squares line from summary statistics:</p>
        <ul>
          <li>
            <p>Estimate the slope parameter, <m>b_1 = (s_y / s_x) R</m>.</p>
          </li>
          <li>
            <p>Noting that the point <m>(\bar{x}, \bar{y})</m> is on the least squares line, use <m>x_0 = \bar{x}</m> and <m>y_0 = \bar{y}</m> with the point-slope equation: <m>y - \bar{y} = b_1 (x - \bar{x})</m>.</p>
          </li>
          <li>
            <p>Simplify the equation, which would reveal that <m>b_0 = \bar{y} - b_1 \bar{x}</m>.</p>
          </li>
        </ul>
      </assemblage>

      <example xml:id="">
        <p>from the sample means and the slope estimate <m>b_1 = -0.0431</m> from Guided Practice <xref ref="findingTheSlopeOfTheLSRLineForIncomeAndAid"/>, find the least-squares line for predicting aid based on family income.} Apply the point-slope equation using <m>(101.78, 19.94)</m> and the slope <m>b_1 = -0.0431</m>:</p>
        <md>
          <mrow>y - y_0 = b_1 (x - x_0)</mrow>
          <mrow>y - \text{19,940} = -0.0431(x - \text{101,780})</mrow>
        </md>
        <p>Expanding the right side and then adding 19,940 to each side, the equation simplifies:</p>
        <me>\widehat{aid} = \text{24,327} - 0.0431 \times \textit{family\us{}income}</me>
        <p>Here we have replaced <m>y</m> with <m>\widehat{aid}</m> and <m>x</m> with <em>family\us{</em>income} to put the equation in context. The final equation should always include a "hat" on the variable being predicted, whether it is a generic "<m>y</m>" or a named variable like "<m>aid</m>".</p>
      </example>

      <p>A computer is usually used to compute the least squares line, and a summary table generated using software for the Elmhurst regression line is shown in <xref ref="rOutputForIncomeAidLSRLine"/>. The first column of numbers provides estimates for <m>{b}_0</m> and <m>{b}_1</m>, respectively. These results match those from <xref ref="exampleToFindLSRLineOfElmhurstData"/> (with some minor rounding error).</p>
      <figure xml:id="rOutputForIncomeAidLSRLine">
      </figure>

      <example xml:id="">
        <p>in <xref ref="rOutputForIncomeAidLSRLine"/>. Can you guess what they represent? (If you have not reviewed any inference chapter yet, skip this example.)} We'll describe the meaning of the columns using the second row, which corresponds to <m>\beta_1</m>. The first column provides the point estimate for <m>\beta_1</m>, as we calculated in an earlier example: <m>b_1 = -0.0431</m>. The second column is a standard error for this point estimate: <m>SE_{b_1} = 0.0108</m>. The third column is a <m>t</m>-test statistic for the null hypothesis that <m>\beta_1 = 0</m>: <m>T = -3.98</m>. The last column is the p-value for the <m>t</m>-test statistic for the null hypothesis <m>\beta_1 = 0</m> and a two-sided alternative hypothesis: 0.0002. We will get into more of these details in <xref ref="inferenceForLinearRegression"/>.</p>
      </example>

      <example xml:id="">
        <p>Elmhurst College. Can she simply use the linear equation that we have estimated to calculate her financial aid from the university? She may use it as an estimate, though some qualifiers on this approach are important. First, the data all come from one freshman class, and the way aid is determined by the university may change from year to year. Second, the equation will provide an imperfect estimate. While the linear equation is good at capturing the trend in the data, no individual student's aid will be perfectly predicted.</p>
      </example>

  </subsection>

    <subsection xml:id="exampleToFindLSRLineOfElmhurstData">
      <title>Interpreting regression model parameter estimates</title>
      <example xml:id="">
        <p>the Elmhurst data are <m>b_0 = \text{24,319}</m> and <m>b_1 = -0.0431</m>. What do these numbers really mean? Interpreting the slope parameter is helpful in almost any application. For each additional \$1,000 of family income, we would expect a student to receive a net difference of <m>\</m>\text{1,000}\times (-0.0431) = -<m>43.10</m> in aid on average, i.e. \$43.10 <em>less</em>. Note that a higher family income corresponds to less aid because the coefficient of family income is negative in the model. We must be cautious in this interpretation: while there is a real association, we cannot interpret a causal connection between the variables because these data are observational. That is, increasing a student's family income may not cause the student's aid to drop. (It would be reasonable to contact the college and ask if the relationship is causal, i.e. if Elmhurst College's aid decisions are partially based on students' family income.)</p>
        <p>The estimated intercept <m>b_0 = \text{24,319}</m> describes the average aid if a student's family had no income. The meaning of the intercept is relevant to this application since the family income for some students at Elmhurst is \$0. In other applications, the intercept may have little or no practical value if there are no observations where <m>x</m> is near zero.</p>
      </example>

      <assemblage>
        <title>Interpreting parameters estimated by least squares</title>
        <p>The slope describes the estimated difference in the <m>y</m> variable if the explanatory variable <m>x</m> for a case happened to be one unit larger. The intercept describes the average outcome of <m>y</m> if <m>x=0</m> <em>and</em> the linear model is valid all the way to <m>x=0</m>, which in many applications is not the case.</p>
      </assemblage>

  </subsection>

    <subsection>
      <title>Extrapolation is treacherous</title>
      <p>{\em\small When those blizzards hit the East Coast this winter, it proved to my satisfaction that global warming was a fraud. That snow was freezing cold. But in an alarming trend, temperatures this spring have risen. Consider this: On February <m>6^{th}</m> it was 10 degrees. Today it hit almost 80. At this rate, by August it will be 220 degrees. So clearly folks the climate debate rages on.}</p>
      <p>Stephen Colbert</p>
      <p>April 6th, 2010\footnote{\oiRedirect{textbook-colbert_extrapolation} {www.cc.com/video-clips/l4nkoq}} \\</p>
      <p>Linear models can be used to approximate the relationship between two variables. However, these models have real limitations. Linear regression is simply a modeling framework. The truth is almost always much more complex than our simple line. For example, we do not know how the data outside of our limited window will behave.</p>
      <example xml:id="">
        <p>$\widehat{aid} = \text{24,319} - 0.0431 \times <em>family\us{</em>income}$ to estimate the aid of another freshman student whose family had income of \$1 million.} We want to calculate the aid for <m>\textit{family\us{}income} = \text{1,000,000}</m>:</p>
        <me>\text{24,319} - 0.0431\times \textit{family\us{}income} = \text{24,319} - 0.0431\times \text{1,000,000} = -\text{18,781}</me>
        <p>The model predicts this student will have -\$18,781 in aid (!). However, Elmhurst College does not offer <em>negative aid</em> where they select some students to pay extra on top of tuition to attend.</p>
      </example>

      <p>Applying a model estimate to values outside of the realm of the original data is called <term>extrapolation</term>. Generally, a linear model is only an approximation of the real relationship between two variables. If we extrapolate, we are making an unreliable bet that the approximate linear relationship will be valid in places where it has not been analyzed.</p>
  </subsection>

    <subsection>
      <title>Using <m>R^2</m> to describe the strength of a fit</title>
      <p>We evaluated the strength of the linear relationship between two variables earlier using the correlation, <m>R</m>. However, it is more common to explain the strength of a linear fit using <m>R^2</m>, called <term>R-squared</term>.  If provided with a linear model, we might like to describe how closely the data cluster around the linear fit.</p>
      <figure xml:id="elmhurstScatterWLSROnly">
      </figure>

      <p>The <m>R^2</m> of a linear model describes the amount of variation in the response that is explained by the least squares line. For example, consider the Elmhurst data, shown in <xref ref="elmhurstScatterWLSROnly"/>. The variance of the response variable, aid received, is about <m>s_{aid}^2 \approx 29.8</m> million. However, if we apply our least squares line, then this model reduces our uncertainty in predicting aid using a student's family income. The variability in the residuals describes how much variation remains after using the model: <m>s_{_{RES}}^2 \approx 22.4</m> million. In short, there was a reduction of</p>
      <me>\frac{s_{aid}^2 - s_{_{RES}}^2}{s_{aid}^2} = \frac{\text{29,800,000} - \text{22,400,000}} {\text{29,800,000}} = \frac{\text{7,500,000}}{\text{29,800,000}} = 0.25</me>
      <p>or about 25 percent in the data's variation by using information about family income for predicting aid using a linear model. This corresponds exactly to the R-squared value:</p>
      <me>R = -0.499 R^2 = 0.25</me>
      <p>About <m>R^2 = (-0.97)^2 = 0.94</m> or 94 percent of the variation is explained by the linear model.}</p>
  </subsection>

    <subsection xml:id="categoricalPredictorsWithTwoLevels">
      <title>Categorical predictors with two levels</title>
      <p>Categorical variables are also useful in predicting outcomes. Here we consider a categorical predictor with two levels (recall that a <em>level</em> is the same as a <em>category</em>). We'll consider Ebay auctions for a video game, <em>Mario Kart</em> for the Nintendo Wii, where both the total price of the auction and the condition of the game were recorded. Here we want to predict total price based on game condition, which takes values "used" and "new". A plot of the auction data is shown in <xref ref="marioKartNewUsed"/>.</p>
      <figure xml:id="marioKartNewUsed">
        <caption>A scatterplot is shown for total auction prices for the video game "Mario Kart", broken down by condition on the horizontal axis. The prices are divided into "used" and "new" condition groups. All used games are shown with an x-value of 0 on the left, and all new games are shown with an x-value of 1 on the right of the plot. The used games on the left show a lower average price of about <m>43, and new games on the right show a higher average price of about \</m>54. The least squares regression line is also shown for this scatterplot, which shows an upward trend and has a formula of "price equals 42.87 plus 10.90 times cond-subscript-new.</caption>
        <image source="ch_regr_simple_linear/figures/marioKartNewUsed"/>
      </figure>

      <p>To incorporate the game condition variable into a regression equation, we must convert the categories into a numerical form. We will do so using an <term>indicator variable</term> called cond_new, which takes value 1 when the game is new and 0 when the game is used. Using this indicator variable, the linear model may be written as</p>
      <me>\widehat{price} = \beta_0 + \beta_1 \times \text{cond\us{new}}</me>
      <p>The parameter estimates are given in <xref ref="marioKartNewUsedRegrSummary"/>, and the model equation can be summarized as</p>
      <me>\widehat{price} = 42.87 + 10.90 \times \text{cond\us{new}}</me>
      <p>For categorical predictors with just two levels, the linearity assumption will always be satisfied. However, we must evaluate whether the residuals in each group are approximately normal and have approximately equal variance. As can be seen in <xref ref="marioKartNewUsed"/>, both of these conditions are reasonably satisfied by the auction data.</p>
      <figure xml:id="marioKartNewUsedRegrSummary">
        <caption>Least squares regression summary for the final auction price against the condition of the game.</caption>
      </figure>

      <example xml:id="">
        <p>model for the price of <em>Mario Kart</em> in eBay auctions.} The intercept is the estimated price when cond_new takes value 0, i.e. when the game is in used condition. That is, the average selling price of a used version of the game is \$42.87.</p>
        <p>The slope indicates that, on average, new games sell for about \$10.90 more than used games.</p>
      </example>

      <assemblage>
        <p>categorical predictors} The estimated intercept is the value of the response variable for the first category (i.e. the category corresponding to an indicator value of 0). The estimated slope is the average change in the response variable between the two categories.</p>
      </assemblage>

      <p>We'll elaborate further on this topic in <xref ref="ch_regr_mult_and_log"/>, where we examine the influence of many predictor variables simultaneously using multiple regression.</p>
      <exercise xml:id="regression_units">
        <title>Units of regression</title>
        <statement>
          <p>Consider a regression predicting weight (kg) from height (cm) for a sample of adult males. What are the units of the correlation coefficient, the intercept, and the slope?</p>
        </statement>
      </exercise>

      <exercise xml:id="which_higher_scatter">
        <title>Which is higher</title>
        <statement>
          <p>Determine if I or II is higher or if they are equal. Explain your reasoning. For a regression line, the uncertainty associated with the slope estimate, <m>b_1</m>, is higher when  \item[I.] there is a lot of scatter around the regression line or \item[II.] there is very little scatter around the regression line </p>
        </statement>
      </exercise>

      <exercise xml:id="residual_apple_weight">
        <title>Over-under, Part I</title>
        <statement>
          <p>Suppose we fit a regression line to predict the shelf life of an apple based on its weight. For a particular apple, we predict the shelf life to be 4.6 days. The apple's residual is -0.6 days. Did we over or under estimate the shelf-life of the apple? Explain your reasoning.</p>
        </statement>
      </exercise>

      <exercise xml:id="residual_sun_cancer">
        <title>Over-under, Part II</title>
        <statement>
          <p>Suppose we fit a regression line to predict the number of incidents of skin cancer per 1,000 people from the number of sunny days in a year. For a particular year, we predict the incidence of skin cancer to be 1.5 per 1,000 people, and the residual for this year is 0.5. Did we over or under estimate the incidence of skin cancer? Explain your reasoning.</p>
        </statement>
      </exercise>

      <exercise xml:id="tourism_spending_reg_conds">
        <title>Tourism spending</title>
        <statement>
          <p>The Association of Turkish Travel Agencies reports the number of foreign tourists visiting Turkey and tourist spending by year.  Three plots are provided: scatterplot showing the relationship between these two variables along with the least squares fit, residuals plot, and histogram of residuals.       \item Describe the relationship between number of tourists and spending. \item What are the explanatory and response variables? \item Why might we want to fit a regression line to these data? \item Do the data meet the conditions required for fitting a least squares line? In addition to the scatterplot, use the residual plot and histogram to answer this question. </p>
        </statement>
      </exercise>

      <exercise xml:id="starbucks_cals_carbos">
        <title>Nutrition at Starbucks, Part I</title>
        <statement>
          <p>The scatterplot below shows the relationship between the number of calories and amount of carbohydrates (in grams) Starbucks food menu items contain. Since Starbucks only lists the number of calories on the display items, we are interested in predicting the amount of carbs a menu item has based on its calorie content.       \item Describe the relationship between number of calories and amount of carbohydrates (in grams) that Starbucks food menu items contain. \item In this scenario, what are the explanatory and response variables? \item Why might we want to fit a regression line to these data? \item Do these data meet the conditions required for fitting a least squares line? </p>
        </statement>
      </exercise>

      <exercise xml:id="coast_starlight_reg">
        <title>The Coast Starlight, Part II</title>
        <statement>
          <p>Exercise <xref ref="coast_starlight_corr_units"/> introduces data on the Coast Starlight Amtrak train that runs from Seattle to Los Angeles. The mean travel time from one stop to the next on the Coast Starlight is 129 mins, with a standard deviation of 113 minutes. The mean distance traveled from one stop to the next is 108 miles with a standard deviation of 99 miles. The correlation between travel time and distance is 0.636.  \item Write the equation of the regression line for predicting travel time. \item Interpret the slope and the intercept in this context. \item Calculate <m>R^2</m> of the regression line for predicting travel time from distance traveled for the Coast Starlight, and interpret <m>R^2</m> in the context of the application. \item The distance between Santa Barbara and Los Angeles is 103 miles. Use the model to estimate the time it takes for the Starlight to travel between these two cities. \item It actually takes the Coast Starlight about 168 mins to travel from Santa Barbara to Los Angeles. Calculate the residual and explain the meaning of this residual value. \item Suppose Amtrak is considering adding a stop to the Coast Starlight 500 miles away from Los Angeles. Would it be appropriate to use this linear model to predict the travel time from Los Angeles to this point? </p>
        </statement>
      </exercise>

      <exercise xml:id="body_measurements_shoulder_height_reg">
        <title>Body measurements, Part III</title>
        <statement>
          <p>Exercise <xref ref="body_measurements_shoulder_height_corr_units"/> introduces data on shoulder girth and height of a group of individuals. The mean shoulder girth is 107.20 cm with a standard deviation of 10.37 cm. The mean height is 171.14 cm with a standard deviation of 9.41 cm. The correlation between height and shoulder girth is 0.67.  \item Write the equation of the regression line for predicting height. \item Interpret the slope and the intercept in this context. \item Calculate <m>R^2</m> of the regression line for predicting height from shoulder girth, and interpret it in the context of the application. \item A randomly selected student from your class has a shoulder girth of 100 cm. Predict the height of this student using the model. \item The student from part (d) is 160 cm tall. Calculate the residual, and explain what this residual means. \item A one year old has a shoulder girth of 56 cm. Would it be appropriate to use this linear model to predict the height of this child? </p>
        </statement>
      </exercise>

      <exercise xml:id="murders_poverty_reg">
        <title>Murders and poverty, Part I</title>
        <statement>
          <p>The following regression output is for predicting annual murders per million from percentage living in poverty in a random sample of 20 metropolitan areas.\\[2mm] {\footnotesize \begin{tabular}{rrrrr} \hline &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(<m>&gt;</m><m>|</m>t<m>|</m>) \\ \hline (Intercept) &amp; -29.901 &amp; 7.789 &amp; -3.839 &amp; 0.001 \\ poverty percent &amp; 2.559 &amp; 0.390 &amp; 6.562 &amp; 0.000 \\ \hline \end{tabular} \\ <m>s = 5.512 R^2 = 70.52\% R^2_{adj} = 68.89\%</m> }  \item Write out the linear model. \item Interpret the intercept. \item Interpret the slope. \item Interpret <m>R^2</m>. \item Calculate the correlation coefficient.  <m>\:</m>\\ </p>
        </statement>
      </exercise>

      <exercise xml:id="cat_body_heart_reg">
        <title>Cats, Part I</title>
        <statement>
          <p>The following regression output is for predicting the heart weight (in g) of cats from their body weight (in kg). The coefficients are estimated using a dataset of 144 domestic cats.\\[2mm] {\footnotesize \begin{tabular}{rrrrr} \hline &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(<m>&gt;</m><m>|</m>t<m>|</m>) \\ \hline (Intercept) &amp; -0.357 &amp; 0.692 &amp; -0.515 &amp; 0.607 \\ body wt &amp; 4.034 &amp; 0.250 &amp; 16.119 &amp; 0.000 \\ \hline \end{tabular} \\ <m>s = 1.452 R^2 = 64.66\% R^2_{adj} = 64.41\%</m> }  \item Write out the linear model. \item Interpret the intercept. \item Interpret the slope. \item Interpret <m>R^2</m>. \item Calculate the correlation coefficient.  <m>\:</m>\\ </p>
        </statement>
      </exercise>

  </subsection>
  </section>

  <section xml:id="typesOfOutliersInLinearRegression">
    <title>Types of outliers in linear regression</title>

    <p>In this section, we identify criteria for determining which outliers are important and influential. Outliers in regression are observations that fall far from the cloud of points. These points are especially important because they can have a strong influence on the least squares line.</p>
    <example xml:id="">
      <ul>
        <li>
          <p>[(1)] There is one outlier far from the other points, though it only appears to slightly influence the line.</p>
        </li>
        <li>
          <p>[(2)] There is one outlier on the right, though it is quite close to the least squares line, which suggests it wasn't very influential.</p>
        </li>
        <li>
          <p>[(3)] There is one point far away from the cloud, and this outlier appears to pull the least squares line up on the right; examine how the line around the primary cloud doesn't appear to fit very well.</p>
        </li>
        <li>
          <p>[(4)] There is a primary cloud and then a small secondary cloud of four outliers. The secondary cloud appears to be influencing the line somewhat strongly, making the least square line fit poorly almost everywhere. There might be an interesting explanation for the dual clouds, which is something that could be investigated.</p>
        </li>
        <li>
          <p>[(5)] There is no obvious trend in the main cloud of points and the outlier on the right appears to largely control the slope of the least squares line.</p>
        </li>
        <li>
          <p>[(6)] There is one outlier far from the cloud. However, it falls quite close to the least squares line and does not appear to be very influential.</p>
        </li>
      </ul>
    </example>

    <figure xml:id="outlierPlots">
      <caption>Six scatterplots, each with a least squares line and residual plot. All data sets have at least one outlier. (1) A clear positive upward trend is evident in the points with a regression line overlaying these points, but one point is shown deviating substantially from the line about one-third of the way from the left side of the plot and far below the other points. (2) A slight downward trend is evident in the points on the left half of the plot with a regression line overlaying these points and extending to a single point on the far right of the plot that is also very close to the regression line. (3) A positive upward trend is evident for points shown on the left two-thirds of the plot with a regression line overlaying these points, but a single point is shown on the far right and lying substantially above the line. This one point appears to be "pulling" the regression line up on the right, making the line fit the rest of the data less well. (4) Most of the data is shown in the left two-thirds of the plot with a clear downward, linear trend. A cluster of 4 points is shown on the far right but deviating notably above the trend of the other points. The regression line fit to the data shows it largely "trying" to fit the bulk of the data on the left but being "pulled" upward on the right towards the cluster of points deviating from the linear trend. (5) A large cluster of points is shown on the far bottom-left, and there is no apparent trend in this large cluster. A single point is shown on the far upper-right. A regression line is fit to the data with a line extending from the cluster on the bottom-left and trending upwards near the single point on the upper right. (6) A clear downward trend is evident in the points on the right two-thirds of the plot with a regression line overlaying these points and extending to a single point on the far left of the plot that is also very close to the regression line.</caption>
      <image source="ch_regr_simple_linear/figures/outlierPlots"/>
    </figure>

    <p>Examine the residual plots in <xref ref="outlierPlots"/>. You will probably find that there is some trend in the main clouds of (3) and (4). In these cases, the outliers influenced the slope of the least squares lines. In (5), data with no clear trend were assigned a line with a large trend simply due to one outlier (!).</p>
    <assemblage>
      <title>Leverage</title>
      <p>Points that fall horizontally away from the center of the cloud tend to pull harder on the line, so we call them points with <term>high leverage</term>.</p>
    </assemblage>

    <p>Points that fall horizontally far from the line are points of high leverage; these points can strongly influence the slope of the least squares line. If one of these high leverage points does appear to actually invoke its influence on the slope of the line – as in cases (3), (4), and (5) of <xref ref="outlierPlotsExample"/> – then we call it an <term>influential point</term>. Usually we can say a point is influential if, had we fitted the line without it, the influential point would have been unusually far from the least squares line.</p>
    <p>It is tempting to remove outliers. Don't do this without a very good reason. Models that ignore exceptional (and interesting) cases often perform poorly. For instance, if a financial firm ignored the largest market swings – the "outliers" – they would soon go bankrupt by making poorly thought-out investments.</p>
    <exercise xml:id="outliers_1">
      <title>Outliers, Part I</title>
      <statement>
        <p>Identify the outliers in the scatterplots shown below, and determine what type of outliers they are. Explain your reasoning.     </p>
      </statement>
    </exercise>

    <exercise xml:id="outliers_2">
      <title>Outliers, Part II</title>
      <statement>
        <p>Identify the outliers in the scatterplots shown below and determine what type of outliers they are. Explain your reasoning.     </p>
      </statement>
    </exercise>

    <exercise xml:id="urban_homeowners_outlier">
      <title>Urban homeowners, Part I</title>
      <statement>
        <p>The scatterplot below shows the percent of families who own their home vs. the percent of the population living in urban areas.  There are 52 observations, each corresponding to a state in the US. Puerto Rico and District of Columbia are also included.  \item Describe the relationship between the percent of families who own their home and the percent of the population living in urban areas. \item The outlier at the bottom right corner is District of Columbia, where 100 percent of the population is considered urban. What type of an outlier is this observation?  <m>\:</m>\\ </p>
      </statement>
    </exercise>

    <exercise xml:id="crawling_babies_outlier">
      <title>Crawling babies, Part II</title>
      <statement>
        <p>Exercise <xref ref="crawling_babies_corr_units"/> introduces data on the average monthly temperature during the month babies first try to crawl (about 6 months after birth) and the average first crawling age for babies born in a given month. A scatterplot of these two variables reveals a potential outlying month when the average temperature is about 53 F and average crawling age is about 28.5 weeks. Does this point have high leverage? Is it an influential point?</p>
      </statement>
    </exercise>

  </section>

  <section xml:id="outlierPlotsExample">
    <title>Inference for linear regression</title>

    <p>In this section, we discuss uncertainty in the estimates of the slope and y-intercept for a regression line. Just as we identified standard errors for point estimates in previous chapters, we first discuss standard errors for these new estimates.</p>
    <subsection xml:id="inferenceForLinearRegression">
      <title>Midterm elections and unemployment</title>
      <p>Elections for members of the United States House of Representatives occur every two years, coinciding every four years with the U.S. Presidential election. The set of House elections occurring during the middle of a Presidential term are called \indexthis{midterm elections}{midterm election}. In America's two-party system, one political theory suggests the higher the unemployment rate, the worse the President's party will do in the midterm elections.</p>
      <p>To assess the validity of this claim, we can compile historical data and look for a connection. We consider every midterm election from 1898 to 2018, with the exception of those elections during the Great Depression. <xref ref="unemploymentAndChangeInHouse"/> shows these data and the least-squares regression line:</p>
      <md>
        <mrow>\text{\% change in House seats for President's party}</mrow>
        <mrow>\qquad\qquad= -7.36 - 0.89 \times \text{(unemployment rate)}</mrow>
      </md>
      <p>We consider the percent change in the number of seats of the President's party (e.g. percent change in the number of seats for Republicans in 2018) against the unemployment rate.</p>
      <p>Examining the data, there are no clear deviations from linearity, the constant variance condition, or substantial outliers. While the data are collected sequentially, a separate analysis was used to check for any apparent correlation between successive observations; no such correlation was found.</p>
      <figure xml:id="unemploymentAndChangeInHouse">
        <caption>A scatterplot is shown for the percent change in House seats for the President's party in each midterm election from 1898 to 2018 plotted against the unemployment rate. The two points for the Great Depression have been removed, and a least squares regression line has been fit to the data with a slightly downward trend. The horizontal axis is for "Unemployment Rate" with values ranging from about 3 percent to 12 percent. The vertical axis is for "Percent Change in Seats of the President's Party in the House of Representatives" with values ranging from about -30 percent to positive 10 percent. The bulk of the observations have Unemployment Rate between 3 percent and 8 percent, and these have the percent change in seats ranging from about -27 percent to positive 4 percent without any discernible trend. There are four observations with unemployment rate above 8 percent, and these have the percent change in seats ranging from -25 percent to -9 percent. Each point in the scatterplot is also labeled as "Democrat" in blue or "Republican" in red, though this doesn't reveal any additional pattern.</caption>
        <image source="ch_regr_simple_linear/figures/unemploymentAndChangeInHouse"/>
      </figure>

      <p>We will provide two considerations. Each of these points would have very high leverage on any least-squares regression line, and years with such high unemployment may not help us understand what would happen in other years where the unemployment is only modestly high. On the other hand, these are exceptional cases, and we would be discarding important information if we exclude them from a final analysis.}</p>
      <p>There is a negative slope in the line shown in <xref ref="unemploymentAndChangeInHouse"/>. However, this slope (and the y-intercept) are only estimates of the parameter values. We might wonder, is this convincing evidence that the "true" linear model has a negative slope? That is, do the data provide strong evidence that the political theory is accurate, where the unemployment rate is a useful predictor of the midterm election? We can frame this investigation into a statistical hypothesis test:</p>
      <ul>
        <li>
          <p>[<m>H_0</m>:] <m>\beta_1 = 0</m>. The true linear model has slope zero.</p>
        </li>
        <li>
          <p>[<m>H_A</m>:] <m>\beta_1 \neq 0</m>. The true linear model has a slope different than zero. The unemployment is predictive of whether the President's party wins or loses seats in the House of Representatives.</p>
        </li>
      </ul>
      <p>We would reject <m>H_0</m> in favor of <m>H_A</m> if the data provide strong evidence that the true slope parameter is different than zero. To assess the hypotheses, we identify a standard error for the estimate, compute an appropriate test statistic, and identify the p-value.</p>
  </subsection>

    <subsection xml:id="testStatisticForTheSlope">
      <title>Understanding regression output from software</title>
      <p>Just like other point estimates we have seen before, we can compute a standard error and test statistic for <m>b_1</m>. We will generally label the test statistic using a <m>T</m>, since it follows the <m>t</m>-distribution.</p>
      <p>We will rely on statistical software to compute the standard error and leave the explanation of how this standard error is determined to a second or third statistics course. <xref ref="midtermUnempRegTable"/> shows software output for the least squares regression line in <xref ref="unemploymentAndChangeInHouse"/>. The row labeled <em>unemp</em> includes the point estimate and other hypothesis test information for the slope, which is the coefficient of the unemployment variable.</p>
      <figure xml:id="midtermUnempRegTable">
      </figure>

      <example xml:id="">
        <!-- Incomplete: of <xref ref="midtermUnempRegTable"/> represent? -->
      <p>The entries in the first column represent the least squares estimates, <m>b_0</m> and <m>b_1</m>, and the values in the second column correspond to the standard errors of each estimate. Using the estimates, we could write the equation for the least square regression line as</p>
        <me>\hat{y} = -7.3644 - 0.8897 x</me>
        <p>where <m>\hat{y}</m> in this case represents the predicted change in the number of seats for the president's party, and <m>x</m> represents the unemployment rate.</p>
      </example>

      <p>We previously used a <m>t</m>-test statistic for hypothesis testing in the context of numerical data. Regression is very similar. In the hypotheses we consider, the null value for the slope is 0, so we can compute the test statistic using the T (or Z) score formula:</p>
      <me>T = \frac{\text{estimate} - \text{null value}}{\text{SE}} = \frac{-0.8897 - 0}{0.8350} = -1.07</me>
      <p>This corresponds to the third column of <xref ref="midtermUnempRegTable"/>.</p>
      <example xml:id="">
      </example>

      <assemblage>
        <title>Inference for regression</title>
        <p>We usually rely on statistical software to identify point estimates, standard errors, test statistics, and p-values in practice. However, be aware that software will not generally check whether the method is appropriate, meaning we must still verify conditions are met.</p>
      </assemblage>

      <example xml:id="">
        <title>Examine Figure <xref ref="elmhurstScatterWLSROnly"/></title>
        <p>which relates the Elmhurst College aid and student family income. How sure are you that the slope is statistically significantly different from zero? That is, do you think a formal hypothesis test would reject the claim that the true slope of the line should be zero? While the relationship between the variables is not perfect, there is an evident decreasing trend in the data. This suggests the hypothesis test will reject the null claim that the slope is zero.</p>
      </example>

      <ul>
      <li>
        <p>[<m>H_0</m>:] The true coefficient for family income is zero.</p>
      </li>
      <li>
        <p>[<m>H_A</m>:] The true coefficient for family income is not zero.</p>
      </li>
    </ul>
    <p>  \footnotetext{We look in the second row corresponding to the family income variable. We see the point estimate of the slope of the line is -0.0431, the standard error of this estimate is 0.0108, and the <m>t</m>-test statistic is <m>T = -3.98</m>. The p-value corresponds exactly to the two-sided test we are interested in: 0.0002. The p-value is so small that we reject the null hypothesis and conclude that family income and financial aid at Elmhurst College for freshman entering in the year 2011 are negatively correlated and the true slope parameter is indeed less than 0, just as we believed in <xref ref="overallAidIncomeInfAssessOfRegrLineSlope"/>.}</p>
    <figure xml:id="rOutputForIncomeAidLSRLineInInferenceSection">
    </figure>

  </subsection>

    <subsection xml:id="overallAidIncomeInfAssessOfRegrLineSlope">
      <title>Confidence interval for a coefficient</title>
      <p>Similar to how we can conduct a hypothesis test for a model coefficient using regression output, we can also construct a confidence interval for that coefficient.</p>
      <example xml:id="">
        <p>Compute the 95 percent confidence interval for the family_income coefficient using the regression output from <xref ref="rOutputForIncomeAidLSRLineInInferenceSection"/>.} The point estimate is -0.0431 and the standard error is <m>SE = 0.0108</m>. When constructing a confidence interval for a model coefficient, we generally use a <m>t</m>-distribution. The degrees of freedom for the distribution are noted in the regression output, <m>df = 48</m>, allowing us to identify <m>t_{48}^{\star} = 2.01</m> for use in the confidence interval.</p>
        <p>We can now construct the confidence interval in the usual way:</p>
        <me>\text{point estimate} \pm t_{48}^{\star} \times SE \qquad\to\qquad -0.0431 \pm 2.01 \times 0.0108 \qquad\to\qquad (-0.0648, -0.0214)</me>
        <p>We are 95 percent confident that with each dollar increase in family_income, the university's gift aid is predicted to decrease on average by <m>0.0214 to \</m>0.0648.</p>
      </example>

      <assemblage>
        <title>Confidence intervals for coefficients</title>
        <p>Confidence intervals for model coefficients can be computed using the <m>t</m>-distribution:</p>
        <me>b_i \ \pm\ t_{df}^{\star} \times SE_{b_{i}}</me>
        <p>where <m>t_{df}^{\star}</m> is the appropriate <m>t</m>-value corresponding to the confidence level with the model's degrees of freedom.</p>
      </assemblage>

      <p>On the topic of intervals in this book, we've focused exclusively on confidence intervals for model parameters. However, there are other types of intervals that may be of interest, including prediction intervals for a response value and also confidence intervals for a mean response value in the context of regression. These two interval types are introduced in an online extra that you may download at  \oiRedirect{stat_extra_linear_regression_supp} {www.openintro.org/d?file=stat_extra_linear_regression_supp} </p>
      <exercise xml:id="body_measurements_weight_height_inf">
        <title>Body measurements, Part IV</title>
        <statement>
          <p>The scatterplot and least squares summary below show the relationship between weight measured in kilograms and height measured in centimeters of 507 physically active individuals.    {\scriptsize  \begin{tabular}{rrrrr} \hline &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(<m>&gt;</m><m>|</m>t<m>|</m>) \\ \hline (Intercept) &amp; -105.0113 &amp; 7.5394 &amp; -13.93 &amp; 0.0000 \\ height &amp; 1.0176 &amp; 0.0440 &amp; 23.13 &amp; 0.0000 \\ \hline \end{tabular}  }  \item Describe the relationship between height and weight. \item Write the equation of the regression line. Interpret the slope and intercept in context. \item Do the data provide strong evidence that an increase in height is associated with an increase in weight? State the null and alternative hypotheses, report the p-value, and state your conclusion. \item The correlation coefficient for height and weight is 0.72. Calculate <m>R^2</m> and interpret it in context. </p>
        </statement>
      </exercise>

      <exercise xml:id="beer_blood_alcohol_inf">
        <title>Beer and blood alcohol content</title>
        <statement>
          <p>Many people believe that gender, weight, drinking habits, and many other factors are much more important in predicting blood alcohol content (BAC) than simply considering the number of drinks a person consumed. Here we examine data from sixteen student volunteers at Ohio State University who each drank a randomly assigned number of cans of beer. These students were evenly divided between men and women, and they differed in weight and drinking habits. Thirty minutes later, a police officer measured their blood alcohol content (BAC) in grams of alcohol per deciliter of blood.  The scatterplot and regression table summarize the findings.    {\scriptsize  \begin{tabular}{rrrrr} \hline &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(<m>&gt;</m><m>|</m>t<m>|</m>) \\ \hline (Intercept) &amp; -0.0127 &amp; 0.0126 &amp; -1.00 &amp; 0.3320 \\ beers &amp; 0.0180 &amp; 0.0024 &amp; 7.48 &amp; 0.0000 \\ \hline \end{tabular}  }  \item Describe the relationship between the number of cans of beer and BAC. \item Write the equation of the regression line. Interpret the slope and intercept in context. \item Do the data provide strong evidence that drinking more cans of beer is associated with an increase in blood alcohol? State the null and alternative hypotheses, report the p-value, and state your conclusion. \item The correlation coefficient for number of cans of beer and BAC is 0.89. Calculate <m>R^2</m> and interpret it in context. \item Suppose we visit a bar, ask people how many drinks they have had, and also take their BAC. Do you think the relationship between number of drinks and BAC would be as strong as the relationship found in the Ohio State study? </p>
        </statement>
      </exercise>

      <exercise xml:id="husbands_wives_height_inf">
        <title>Husbands and wives, Part II</title>
        <statement>
          <p>The scatterplot below summarizes husbands' and wives' heights in a random sample of 170 married couples in Britain, where both partners' ages are below 65 years. Summary output of the least squares fit for predicting wife's height from husband's height is also provided in the table.    {\scriptsize  \begin{tabular}{rrrrr} \hline &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(<m>&gt;</m><m>|</m>t<m>|</m>) \\ \hline (Intercept) &amp; 43.5755 &amp; 4.6842 &amp; 9.30 &amp; 0.0000 \\ height_husband &amp; 0.2863 &amp; 0.0686 &amp; 4.17 &amp; 0.0000 \\ \hline \end{tabular}  }  \item Is there strong evidence that taller men marry taller women? State the hypotheses and include any information used to conduct the test. \item Write the equation of the regression line for predicting wife's height from husband's height. \item Interpret the slope and intercept in the context of the application. \item Given that <m>R^2 = 0.09</m>, what is the correlation of heights in this data set? \item You meet a married man from Britain who is 5'9" (69 inches). What would you predict his wife's height to be? How reliable is this prediction? \item You meet another married man from Britain who is 6'7" (79 inches). Would it be wise to use the same linear model to predict his wife's height? Why or why not? </p>
        </statement>
      </exercise>

      <exercise xml:id="urban_homeowners_cond">
        <title>Urban homeowners, Part II</title>
        <statement>
          <p>Exercise <xref ref="urban_homeowners_outlier"/> gives a scatterplot displaying the relationship between the percent of families that own their home and the percent of the population living in urban areas. Below is a similar scatterplot, excluding District of Columbia, as well as the residuals plot. There were 51 cases. { \item For these data, <m>R^2=0.28</m>. What is the correlation? How can you tell if it is positive or negative? \item Examine the residual plot. What do you observe? Is a simple least squares fit appropriate for these data? } <m>\:</m> \\   </p>
        </statement>
      </exercise>

      <exercise xml:id="murders_poverty_inf">
        <title>Murders and poverty, Part II</title>
        <statement>
          <p>Exercise <xref ref="murders_poverty_reg"/> presents regression output from a model for predicting annual murders per million from percentage living in poverty based on a random sample of 20 metropolitan areas. The model output is also provided below.  \begin{tabular}{rrrrr} \hline &amp; Estimate &amp; Std. Error &amp; t value &amp; Pr(<m>&gt;</m><m>|</m>t<m>|</m>) \\ \hline (Intercept) &amp; -29.901 &amp; 7.789 &amp; -3.839 &amp; 0.001 \\ poverty percent &amp; 2.559 &amp; 0.390 &amp; 6.562 &amp; 0.000 \\ \hline \end{tabular} <me> s = 5.512 \qquad R^2 = 70.52\% \qquad R^2_{adj} = 68.89\% </me>   \item What are the hypotheses for evaluating whether poverty percentage is a significant predictor of murder rate? \item State the conclusion of the hypothesis test from part (a) in context of the data. \item Calculate a 95 percent confidence interval for the slope of poverty percentage, and interpret it in context of the data. \item Do your results from the hypothesis test and the confidence interval agree? Explain. </p>
        </statement>
      </exercise>

      <exercise xml:id="babies_head_gestation_inf">
        <title>Babies</title>
        <statement>
          <p>Is the gestational age (time between conception and birth) of a low birth-weight baby useful in predicting head circumference at birth? Twenty-five low birth-weight babies were studied at a Harvard teaching hospital; the investigators calculated the regression of head circumference (measured in centimeters) against gestational age (measured in weeks). The estimated regression line is <me> \widehat{head~circumference} = 3.91 + 0.78 \times gestational~age </me>  \item What is the predicted head circumference for a baby whose gestational age is 28 weeks? \item The standard error for the coefficient of gestational age is 0. 35, which is associated with <m>df=23</m>. Does the model provide strong evidence that gestational age is significantly associated with head circumference? </p>
        </statement>
      </exercise>

  </subsection>
  </section>

</chapter>